
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{student\_final\_v2\_share}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{final-project-submission}{%
\section{Final Project Submission}\label{final-project-submission}}

Please fill out: * Student name: James M. Irving * Student pace: full
time * Scheduled project review date/time: 03/14/19 at 9 am * Instructor
name: Jeff Herman * Blog post URL: \_\_\_

    \hypertarget{outline-of-data-processing-and-analysisusing-osemn-model}{%
\section{Outline of Data Processing and Analysis(using OSEMN
model)}\label{outline-of-data-processing-and-analysisusing-osemn-model}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{OBTAIN:} \textbf{Import data, inspect, check for datatypes to
  convert and null values}

  \begin{itemize}
  \tightlist
  \item
    Display header and info
  \item
    Drop any unneeded columns (df.drop({[}`col1',`col2'{]},axis=1)
  \end{itemize}
\item
  \textbf{SCRUB: cast data types, identify outliers, check for
  multicollinearity, normalize data}

  \begin{itemize}
  \tightlist
  \item
    Check and cast data types

    \begin{itemize}
    \tightlist
    \item
      {[}x{]} Check for \#'s that are store as objects (df.info())

      \begin{itemize}
      \tightlist
      \item
        when converting to \#'s, look for odd values (like many 0's), or
        strings that can't be converted
      \item
        Decide how to deal weird/null values (df.unique(),
        df.isna().sum(), df.describe()-min/max, etc
      \end{itemize}
    \item
      {[}x{]} Check for categorical variables stored as integers
    \end{itemize}
  \item
    {[}x{]} Check for missing values (df.isna().sum())

    \begin{itemize}
    \tightlist
    \item
      Can drop rows or colums
    \item
      For missing numeric data with median or bin/convert to categorical
    \item
      For missing categorical data: make NaN own category OR replace
      with most common category
    \end{itemize}
  \item
    {[}X{]} Check for multicollinearity

    \begin{itemize}
    \tightlist
    \item
      use seaborn to make correlation matrix plot
      \href{https://www.evernote.com/l/AArNyaEwjA5JUL6I9PazHs_ts_hU-m7ja1I/}{Evernote
      Link}
    \item
      Good rule of thumb is anything over 0.75 corr is high, remove the
      variable that has the most correl with the largest \# of variables
    \end{itemize}
  \item
    {[}x{]} Normalize data (may want to do after some exploring)

    \begin{itemize}
    \tightlist
    \item
      Most popular is Z-scoring (but won't fix skew)
    \item
      Can log-transform to fix skewed data
    \end{itemize}
  \end{itemize}
\item
  \textbf{EXPLORE:Check distributions, outliers, etc}

  \begin{itemize}
  \tightlist
  \item
    {[}x{]} Check scales, ranges (df.describe())
  \item
    {[}x{]} Check histograms to get an idea of distributions (df.hist())
    and dat transformations to perform

    \begin{itemize}
    \tightlist
    \item
      Can also do kernel density estimates
    \end{itemize}
  \item
    {[}x{]} Use scatterplots to check for linearity and possible
    categorical variables (df.plot(kind-`scatter')

    \begin{itemize}
    \tightlist
    \item
      categoricals will look like vertical lines
    \end{itemize}
  \item
    {[}x{]} Use pd.plotting.scatter\_matrix to visualize possible
    relationships
  \item
    {[}x{]} Check for linearity
  \end{itemize}
\item
  \textbf{FIT AN INITIAL MODEL:}

  \begin{itemize}
  \tightlist
  \item
    Various forms, detail later\ldots{}
  \item
    \textbf{Assessing the model:}

    \begin{itemize}
    \tightlist
    \item
      Assess parameters (slope,intercept)
    \item
      Check if the model explains the variation in the data (RMSE, F,
      R\_square)
    \item
      \emph{Are the coeffs, slopes, intercepts in appropriate units?}
    \item
      \emph{Whats the impact of collinearity? Can we ignore?}
    \end{itemize}
  \end{itemize}
\item
  \textbf{Revise the fitted model}

  \begin{itemize}
  \tightlist
  \item
    Multicollinearity is big issue for lin regression and cannot fully
    remove it
  \item
    Use the predictive ability of model to test it (like R2 and RMSE)
  \item
    Check for missed non-linearity
  \end{itemize}
\item
  \textbf{Holdout validation / Train/test split}

  \begin{itemize}
  \tightlist
  \item
    use sklearn train\_test\_split \_\_\_
  \end{itemize}
\end{enumerate}

    Table of Contents (Links){}

{Final Project Submission}

{Outline of Data Processing and Analysis(using OSEMN model)}

{OBTAIN:}

{Define functions to be used}

{def check\_column(series, nlargest):}

{def log\_z(col):}

{def rem\_out\_z(col\_name):}

{def multiplot(df):}

{def plot\_hist\_scat(df,target,stats):}

{def plot\_hist\_scat\_sns(df,target,stats):}

{def detect\_outliers(df,n,features): (using IQRs)}

{SCRUB:}

{Fill in null values and recast variables for EDA}

{zipcode}

{sqft\_basement}

{View}

{Waterfront}

{yr\_renovated --\textgreater{} is\_reno}

{SCRUBBING THUS FAR\ldots{}}

{Question 1: Which predictors should be analyzed as continuous data, vs
binned/categorical data?}

{Answer 1: How to treat each variable}

{List of vartypes/names}

{COARSE-BINNING Numerical Data}

{binning yr\_built}

{binning sqft\_basement}

{binning sqft\_above}

{CHECKING FOR MULTICOLLINEARITY}

{Question 2:Which predictors are closely related and should be dropped?}

{Answer 2:}

{EXPLORE:}

{EDA before normalization/transformation}

{Examine basic descriptive stats}

{Visualizing numerical data}

{Visualizing categorical data}

{Question/Answer 3A: Which categorical variables show the greatest
potential as predictors?}

{{[}SCRUB-2{]} NORMALIZING \& TRANSFORMING}

{Outlier Removal - visualizing}

{Question/Answer 3B: Does removal of outliers improve the distrubtions?}

{REMOVING OUTLIERS}

{Filling in df\_norm}

{NORMALIZING UNITS (RobustScaler)}

{CHECKING NORMALIZED DATASET}

{Recheck multipol}

{CAT.CODES FOR BINNED DATA}

{Concatenate final df for modeling (df\_run)}

{Saving/loading df\_run after cleaning up}

{FITTING AN INTIAL MODEL:}

{DETERMINING IDEAL FEATURES TO USE}

{Using elbow plots to identify the best \# of features to use}

{Choosing Features Based on Rankings}

{PRELIMINARY UNIVARIATE LINEAR REGRESSION MODELING}

{MULTIVARIATE REGRESSIONS}

{Final Model for Validation:}

{Save df\_run\_ols to csv}

{NEW REGRESSION RESULTS}

{K-Fold valiation with OLS}

{Q-Q Plots}

{FINAL MODEL - New}

{Predictor Coefficients \& Their Affect On Sales Price}

{Future Directions}

{SUMMARY FIGURES FOR PRESENTATION}

{ORIGINAL REGRESSION FROM FIRST ITERATION}

{Regression Diagnostics}

{Final Model (original)}

{Predictor Coefficients \& Their Affect On Sales Price}

    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

    \hypertarget{obtain}{%
\section{OBTAIN:}\label{obtain}}

\begin{itemize}
\tightlist
\item
  Import required packages, read in dataframe, and definefunctions
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seaborn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{smf}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{normaltest} \PY{k}{as} \PY{n}{normtest} \PY{c+c1}{\PYZsh{} D\PYZsq{}Agostino and Pearson\PYZsq{}s omnibus test}
        
        \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{Counter}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{RobustScaler}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{MinMaxScaler}
        
        \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kc\PYZus{}house\PYZus{}data.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}   
        \PY{c+c1}{\PYZsh{} Set index, create dataframe for dropped variables with id as index for both}
        \PY{n}{df}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{drop\PYZus{}me} \PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{long}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{df\PYZus{}dropped} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{n}{df\PYZus{}dropped}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{drop\PYZus{}me}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{df}\PY{o}{.}\PY{n}{index}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}2}]:} RangeIndex(start=0, stop=21597, step=1)
\end{Verbatim}
            
    \hypertarget{define-functions-to-be-used}{%
\subsection{Define functions to be
used}\label{define-functions-to-be-used}}

    \hypertarget{def-check_columnseries-nlargest}{%
\subsubsection{def check\_column(series,
nlargest):}\label{def-check_columnseries-nlargest}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} Check columns will }
        \PY{k}{def} \PY{n+nf}{check\PYZus{}column}\PY{p}{(}\PY{n}{series}\PY{p}{,}\PY{n}{nlargest}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Column: df[}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+si}{\PYZob{}series.name\PYZcb{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{]}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dtype: }\PY{l+s+si}{\PYZob{}series.dtype\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{isna: }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{series.isna().sum()\PYZcb{} out of }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{len(series)\PYZcb{} \PYZhy{} }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{round(series.isna().sum()/len(series)*100,3)\PYZcb{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
                
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Unique non\PYZhy{}na values:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{},df[\PYZsq{}waterfront\PYZsq{}].unique())}
            \PY{k}{if} \PY{n}{nlargest} \PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{n}{series}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{n}{series}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{nlargest}\PY{p}{(}\PY{n}{nlargest}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \hypertarget{def-log_zcol}{%
\subsubsection{def log\_z(col):}\label{def-log_zcol}}

\begin{itemize}
\tightlist
\item
  Logs the column then z-scores
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{} define log + z\PYZhy{}score}
        \PY{k}{def} \PY{n+nf}{log\PYZus{}z}\PY{p}{(}\PY{n}{col}\PY{p}{)}\PY{p}{:}
            
            \PY{n}{col} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{col}\PY{p}{)}
            \PY{n}{logcol} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{col}\PY{p}{)}
            
            \PY{n}{zlogcol} \PY{o}{=} \PY{p}{(}\PY{n}{logcol}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{logcol}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{n}{logcol}\PY{p}{)}\PY{p}{)}
            
            \PY{k}{return} \PY{n}{zlogcol}
\end{Verbatim}


    \hypertarget{def-rem_out_zcol_name}{%
\subsubsection{def
rem\_out\_z(col\_name):}\label{def-rem_out_zcol_name}}

\begin{itemize}
\tightlist
\item
  Logs the column then z-scores and removes zscores\textgreater{}3
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k}{def} \PY{n+nf}{rem\PYZus{}out\PYZus{}z}\PY{p}{(}\PY{n}{col\PYZus{}name}\PY{p}{)}\PY{p}{:}
        
            \PY{n}{col} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{col\PYZus{}name}\PY{p}{)}
            \PY{n}{z\PYZus{}col} \PY{o}{=} \PY{p}{(}\PY{n}{col} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{col}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{n}{col}\PY{p}{)}\PY{p}{)}
            \PY{n}{z\PYZus{}col}\PY{p}{[}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{z\PYZus{}col}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nan}
            \PY{k}{return} \PY{n}{z\PYZus{}col}
\end{Verbatim}


    \hypertarget{def-multiplotdf}{%
\subsubsection{def multiplot(df):}\label{def-multiplotdf}}

\begin{itemize}
\tightlist
\item
  plots heat map of correlation values of input dataframe
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{} MULTIPLOT}
        \PY{k+kn}{from} \PY{n+nn}{string} \PY{k}{import} \PY{n}{ascii\PYZus{}letters}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        
        \PY{k}{def} \PY{n+nf}{multiplot}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
        
            \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{white}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} Compute the correlation matrix}
            \PY{n}{corr} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} Generate a mask for the upper triangle}
            \PY{n}{mask} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros\PYZus{}like}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{bool}\PY{p}{)}
            \PY{n}{mask}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{triu\PYZus{}indices\PYZus{}from}\PY{p}{(}\PY{n}{mask}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PY{k+kc}{True}
        
            \PY{c+c1}{\PYZsh{} Set up the matplotlib figure}
            \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{)}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} Generate a custom diverging colormap}
            \PY{n}{cmap} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{diverging\PYZus{}palette}\PY{p}{(}\PY{l+m+mi}{220}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{as\PYZus{}cmap}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} Draw the heatmap with the mask and correct aspect ratio}
            \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{mask}\PY{o}{=}\PY{n}{mask}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{cmap}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                        
            \PY{n}{square}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{cbar\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{shrink}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{o}{.}\PY{l+m+mi}{5}\PY{p}{\PYZcb{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}}
\end{Verbatim}


    \hypertarget{def-plot_hist_scatdftargetstats}{%
\subsubsection{def
plot\_hist\_scat(df,target,stats):}\label{def-plot_hist_scatdftargetstats}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{} Plots histogram and scatter (vs price) side by side}
        \PY{k}{def} \PY{n+nf}{plot\PYZus{}hist\PYZus{}scat}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{n}{target}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stats}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}     plt.style.use(\PYZsq{}bmh\PYZsq{})}
        \PY{c+c1}{\PYZsh{}     plt.style.use(\PYZsq{}fivethirtyeight\PYZsq{})}
            \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fivethirtyeight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}     fontTitle = \PYZob{}\PYZsq{}family\PYZsq{}: \PYZsq{}serif\PYZsq{},}
        \PY{c+c1}{\PYZsh{}             \PYZsq{}color\PYZsq{}:  \PYZsq{}black\PYZsq{},}
        \PY{c+c1}{\PYZsh{}             \PYZsq{}weight\PYZsq{}: \PYZsq{}normal\PYZsq{},}
        \PY{c+c1}{\PYZsh{}             \PYZsq{}size\PYZsq{}: 16,}
        \PY{c+c1}{\PYZsh{}             \PYZcb{}}
        \PY{c+c1}{\PYZsh{}     fontTicks = \PYZob{}\PYZsq{}family\PYZsq{}: \PYZsq{}sans\PYZhy{}serif\PYZsq{},}
        \PY{c+c1}{\PYZsh{}             \PYZsq{}color\PYZsq{}:  \PYZsq{}black\PYZsq{},}
        \PY{c+c1}{\PYZsh{}             \PYZsq{}weight\PYZsq{}: \PYZsq{}normal\PYZsq{},}
        \PY{c+c1}{\PYZsh{}             \PYZsq{}size\PYZsq{}: 10,}
        \PY{c+c1}{\PYZsh{}             \PYZcb{}}
            \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{column}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{K\PYZus{}square}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}val}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        
        
            \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        
                \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)} \PY{p}{)}\PY{c+c1}{\PYZsh{}plt.figaspect(0.5))\PYZsh{}(5,4))}
                \PY{n}{ax1} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
                
                \PY{n}{ax1}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{,}\PY{n}{density}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{n}{column}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ histogram}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
                \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{column}\PY{o}{.}\PY{n}{capitalize}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        
                \PY{n}{ax1}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
                
                \PY{n}{ax2} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
                \PY{n}{ax2}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{n}{target}\PY{p}{]}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{n}{column}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ vs price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{column}\PY{o}{.}\PY{n}{capitalize}\PY{p}{(}\PY{p}{)}\PY{p}{)}
                \PY{n}{ax2}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
        
                \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
                \PY{k}{if} \PY{n}{stats}\PY{o}{==}\PY{k+kc}{True}\PY{p}{:}
                    \PY{n}{stat}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{normtest}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}             print(f\PYZsq{}Normality test for \PYZob{}column\PYZcb{}:K\PYZus{}square = \PYZob{}stat\PYZcb{}, p\PYZhy{}value = \PYZob{}p\PYZcb{}\PYZsq{})}
        
                    \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{column}\PY{p}{,}\PY{n}{stat}\PY{p}{,} \PY{n}{p}\PY{p}{]}\PY{p}{)}
            \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
\end{Verbatim}


    \hypertarget{def-plot_hist_scat_snsdftargetstats}{%
\subsubsection{def
plot\_hist\_scat\_sns(df,target,stats):}\label{def-plot_hist_scat_snsdftargetstats}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{}SEABORN}
        \PY{c+c1}{\PYZsh{} Plots histogram and scatter (vs price) side by side}
        \PY{k}{def} \PY{n+nf}{plot\PYZus{}hist\PYZus{}scat\PYZus{}sns}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{n}{target}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{stats}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
            \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dark\PYZus{}background}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{column}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{K\PYZus{}square}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}val}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
        
            \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} for column in df:}
        
                \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)} \PY{p}{)}\PY{c+c1}{\PYZsh{}plt.figaspect(0.5))\PYZsh{}(5,4))}
                \PY{n}{ax1} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
                \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{,}\PY{n}{kde}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{n}{column}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ histogram}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{norm\PYZus{}hist}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax1}\PY{p}{)}
        
                \PY{n}{ax1}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{n}{column}\PY{o}{.}\PY{n}{capitalize}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}         ax1.legend()}
            
                \PY{n}{ax2} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
                \PY{n}{sns}\PY{o}{.}\PY{n}{stripplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{p}{[}\PY{n}{target}\PY{p}{]}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax2}\PY{p}{)}
                \PY{n}{ax2}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{n}{column}\PY{o}{.}\PY{n}{capitalize}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}         ax2.legend()}
        
                \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
                \PY{k}{if} \PY{n}{stats}\PY{o}{==}\PY{k+kc}{True}\PY{p}{:}
                    \PY{n}{stat}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{normtest}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{)}
                    \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Normality test for }\PY{l+s+si}{\PYZob{}column\PYZcb{}}\PY{l+s+s1}{:K\PYZus{}square = }\PY{l+s+si}{\PYZob{}stat\PYZcb{}}\PY{l+s+s1}{, p\PYZhy{}value = }\PY{l+s+si}{\PYZob{}p\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
                    \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{column}\PY{p}{,}\PY{n}{stat}\PY{p}{,} \PY{n}{p}\PY{p}{]}\PY{p}{)}
            \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
\end{Verbatim}


    \hypertarget{def-detect_outliersdfnfeatures-using-iqrs}{%
\subsubsection{def detect\_outliers(df,n,features): (using
IQRs)}\label{def-detect_outliersdfnfeatures-using-iqrs}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{} Tukey\PYZsq{}s method using IQR to eliminate }
        \PY{k}{def} \PY{n+nf}{detect\PYZus{}outliers}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{n}{n}\PY{p}{,}\PY{n}{features}\PY{p}{)}\PY{p}{:}
            \PY{n}{outlier\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
            \PY{c+c1}{\PYZsh{} iterate over features(columns)}
            \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{features}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} 1st quartile (25\PYZpc{})}
                \PY{n}{Q1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} 3rd quartile (75\PYZpc{})}
                \PY{n}{Q3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{percentile}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{75}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} Interquartile range (IQR)}
                \PY{n}{IQR} \PY{o}{=} \PY{n}{Q3} \PY{o}{\PYZhy{}} \PY{n}{Q1}
                \PY{c+c1}{\PYZsh{} outlier step}
                \PY{n}{outlier\PYZus{}step} \PY{o}{=} \PY{l+m+mf}{1.5} \PY{o}{*} \PY{n}{IQR}
                \PY{c+c1}{\PYZsh{} Determine a list of indices of outliers for feature col}
                \PY{n}{outlier\PYZus{}list\PYZus{}col} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{Q1} \PY{o}{\PYZhy{}} \PY{n}{outlier\PYZus{}step}\PY{p}{)} \PY{o}{|} \PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{Q3} \PY{o}{+} \PY{n}{outlier\PYZus{}step} \PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{index}
                \PY{c+c1}{\PYZsh{} append the found outlier indices for col to the list of outlier indices }
                \PY{n}{outlier\PYZus{}indices}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n}{outlier\PYZus{}list\PYZus{}col}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} select observations containing more than 2 outliers}
                \PY{n}{outlier\PYZus{}indices} \PY{o}{=} \PY{n}{Counter}\PY{p}{(}\PY{n}{outlier\PYZus{}indices}\PY{p}{)}        
                \PY{n}{multiple\PYZus{}outliers} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(} \PY{n}{k} \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{outlier\PYZus{}indices}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{v} \PY{o}{\PYZgt{}} \PY{n}{n} \PY{p}{)}
                \PY{k}{return} \PY{n}{multiple\PYZus{}outliers} 
        \PY{c+c1}{\PYZsh{} Outliers\PYZus{}to\PYZus{}drop = detect\PYZus{}outliers(data,2,[\PYZdq{}col1\PYZdq{},\PYZdq{}col2\PYZdq{}])}
        \PY{c+c1}{\PYZsh{} df.loc[Outliers\PYZus{}to\PYZus{}drop] \PYZsh{} Show the outliers rows}
        \PY{c+c1}{\PYZsh{} Drop outliers}
        \PY{c+c1}{\PYZsh{} data= data.drop(Outliers\PYZus{}to\PYZus{}drop, axis = 0).reset\PYZus{}index(drop=True)}
\end{Verbatim}


    \hypertarget{scrub}{%
\section{SCRUB:}\label{scrub}}

\hypertarget{initial-inspection-of-dataframe-datatypes-and-null-values}{%
\paragraph{Initial inspection of dataframe, datatypes, and null
values}\label{initial-inspection-of-dataframe-datatypes-and-null-values}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:}       price  bedrooms  bathrooms  sqft\_living  sqft\_lot  floors  waterfront  \textbackslash{}
         0  221900.0         3       1.00         1180      5650     1.0         NaN   
         1  538000.0         3       2.25         2570      7242     2.0         0.0   
         2  180000.0         2       1.00          770     10000     1.0         0.0   
         3  604000.0         4       3.00         1960      5000     1.0         0.0   
         4  510000.0         3       2.00         1680      8080     1.0         0.0   
         
            view  condition  grade  sqft\_above sqft\_basement  yr\_built  yr\_renovated  \textbackslash{}
         0   0.0          3      7        1180           0.0      1955           0.0   
         1   0.0          3      7        2170         400.0      1951        1991.0   
         2   0.0          3      6         770           0.0      1933           NaN   
         3   0.0          5      7        1050         910.0      1965           0.0   
         4   0.0          3      8        1680           0.0      1987           0.0   
         
            zipcode  sqft\_living15  sqft\_lot15  
         0    98178           1340        5650  
         1    98125           1690        7639  
         2    98028           2720        8062  
         3    98136           1360        5000  
         4    98074           1800        7503  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{} Display DataFrame Infro}
         \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 21597 entries, 0 to 21596
Data columns (total 17 columns):
price            21597 non-null float64
bedrooms         21597 non-null int64
bathrooms        21597 non-null float64
sqft\_living      21597 non-null int64
sqft\_lot         21597 non-null int64
floors           21597 non-null float64
waterfront       19221 non-null float64
view             21534 non-null float64
condition        21597 non-null int64
grade            21597 non-null int64
sqft\_above       21597 non-null int64
sqft\_basement    21597 non-null object
yr\_built         21597 non-null int64
yr\_renovated     17755 non-null float64
zipcode          21597 non-null int64
sqft\_living15    21597 non-null int64
sqft\_lot15       21597 non-null int64
dtypes: float64(6), int64(10), object(1)
memory usage: 2.8+ MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{} Check for columns with null values (remember strings/objects are not counted here)}
         \PY{n}{res} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{n}{res}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Total:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Waterfront, view, yr\PYZus{}renovated have missing values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
waterfront      2376
view              63
yr\_renovated    3842
dtype: int64 
Total: 21597

    \end{Verbatim}

    \hypertarget{fill-in-null-values-and-recast-variables-for-eda}{%
\subsection{Fill in null values and recast variables for
EDA}\label{fill-in-null-values-and-recast-variables-for-eda}}

\begin{itemize}
\tightlist
\item
  From examining the df.info and df.isna().sum(), there is 1 numerical
  data column that is currently text/object data type.

  \begin{itemize}
  \tightlist
  \item
    I will address these first since they would be excluded from
    preliminary visualizations.
  \end{itemize}
\item
  There are also null values to address in waterfront, view, and
  yr\_renovated
\item
  The Date column will be recast as datetime
\end{itemize}

    \hypertarget{zipcode}{%
\subsubsection{zipcode}\label{zipcode}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{} Recast zipcode as a category}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \hypertarget{sqft_basement}{%
\subsubsection{sqft\_basement}\label{sqft_basement}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{} RECASTING SQFT\PYZus{}BASEMENT}
         \PY{c+c1}{\PYZsh{} Checking why sqft\PYZus{}basement might be an object:}
         \PY{c+c1}{\PYZsh{} df[\PYZsq{}sqft\PYZus{}basement\PYZsq{}].value\PYZus{}counts().nlargest(10)}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['sqft\_basement']':
dtype: object
isna: 0 out of 21597 - 0.0\%

Unique non-na values:
0.0       12826
?           454
600.0       217
500.0       209
700.0       208
800.0       201
400.0       184
1000.0      148
300.0       142
900.0       142
Name: sqft\_basement, dtype: int64

    \end{Verbatim}

    \begin{itemize}
\tightlist
\item
  \textbf{sqft\_basement is current an object, needs to be converted to
  int}

  \begin{itemize}
  \tightlist
  \item
    Need to \sout{replace} drop the 454 `?' values
  \item
    There are a lot of 0's, for sqft\_basement. Not sure if I should
    keep them in the dataset. I am for now.
  \item
    \emph{Note: I originally replaced the ?'s with 0's, but am
    re-running the dataset with them dropped altogether.}
  \end{itemize}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{} Removing rows with ? for sqft\PYZus{}basement and converting to float}
         \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{to\PYZus{}replace} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{?}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{value}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)} \PY{c+c1}{\PYZsh{},inplace=True)}
         \PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
21597
Column: df['sqft\_basement']':
dtype: float64
isna: 0 out of 21143 - 0.0\%

Unique non-na values:
0.0       12826
600.0       217
500.0       209
700.0       208
800.0       201
400.0       184
1000.0      148
900.0       142
300.0       142
200.0       105
Name: sqft\_basement, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21143 entries, 0 to 21596
Data columns (total 17 columns):
price            21143 non-null float64
bedrooms         21143 non-null int64
bathrooms        21143 non-null float64
sqft\_living      21143 non-null int64
sqft\_lot         21143 non-null int64
floors           21143 non-null float64
waterfront       18804 non-null float64
view             21082 non-null float64
condition        21143 non-null int64
grade            21143 non-null int64
sqft\_above       21143 non-null int64
sqft\_basement    21143 non-null float64
yr\_built         21143 non-null int64
yr\_renovated     17389 non-null float64
zipcode          21143 non-null category
sqft\_living15    21143 non-null int64
sqft\_lot15       21143 non-null int64
dtypes: category(1), float64(7), int64(9)
memory usage: 2.8 MB

    \end{Verbatim}

    \hypertarget{view}{%
\subsubsection{View}\label{view}}

\begin{itemize}
\tightlist
\item
  \sout{Replace the 61 null values with appropriate value for data type}
\item
  Drop the 61 view null values
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{} Check for columns with null values (remember strings/objects are not counted here)}
         \PY{n}{res} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{res}\PY{p}{[}\PY{n}{res}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Waterfront, view, yr\PYZus{}renovated have missing values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
waterfront      2339
view              61
yr\_renovated    3754
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['view']':
dtype: float64
isna: 61 out of 21143 - 0.289\%

Unique non-na values:
0.0    19018
2.0      930
3.0      496
1.0      327
4.0      311
Name: view, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} Drop null values from view and re\PYZhy{}check column}
         \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{)}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
21143
21082
Column: df['view']':
dtype: float64
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
0.0    19018
2.0      930
3.0      496
1.0      327
4.0      311
Name: view, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{} Convert view to category and create a coded version called code\PYZus{}view}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code\PYZus{}view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{view}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{codes}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code\PYZus{}view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:} 0    19018
         2      930
         3      496
         1      327
         4      311
         Name: code\_view, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{} Drop drop\PYZus{}me variable from main df, save in df\PYZus{}dropped}
         \PY{n}{drop\PYZus{}me} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{df\PYZus{}dropped}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{drop\PYZus{}me}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{}Recheck whole df}
         \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21082 entries, 0 to 21596
Data columns (total 17 columns):
price            21082 non-null float64
bedrooms         21082 non-null int64
bathrooms        21082 non-null float64
sqft\_living      21082 non-null int64
sqft\_lot         21082 non-null int64
floors           21082 non-null float64
waterfront       18749 non-null float64
condition        21082 non-null int64
grade            21082 non-null int64
sqft\_above       21082 non-null int64
sqft\_basement    21082 non-null float64
yr\_built         21082 non-null int64
yr\_renovated     17340 non-null float64
zipcode          21082 non-null category
sqft\_living15    21082 non-null int64
sqft\_lot15       21082 non-null int64
code\_view        21082 non-null int8
dtypes: category(1), float64(6), int64(9), int8(1)
memory usage: 2.6 MB

    \end{Verbatim}

    \hypertarget{waterfront}{%
\subsubsection{Waterfront}\label{waterfront}}

\begin{itemize}
\tightlist
\item
  Recast as \sout{int} string
\item
  Waterfront has 2339 null values to \sout{replace.} make into
  \textbf{unordered and coded into ``NaN''} category

  \begin{itemize}
  \tightlist
  \item
    Note this is string ``NaN'' not np.nan
  \end{itemize}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['waterfront']':
dtype: float64
isna: 2333 out of 21082 - 11.066\%

Unique non-na values:
0.0    18608
1.0      141
Name: waterfront, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{} Convert waterfront to category, replace null values with \PYZdq{}NaN\PYZdq{}\PYZsq{} string to make it a category}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{NaN}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{c+c1}{\PYZsh{} df[\PYZsq{}waterfront\PYZsq{}].value\PYZus{}counts()}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['waterfront']':
dtype: category
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
0.0    18608
NaN     2333
1.0      141
Name: waterfront, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{c+c1}{\PYZsh{} Turn waterfront into coded column }
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code\PYZus{}waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{waterfront}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{codes}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code\PYZus{}waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['code\_waterfront']':
dtype: int8
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
0    18608
2     2333
1      141
Name: code\_waterfront, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{} Drop drop\PYZus{}me variable from main df, save in df\PYZus{}dropped}
         \PY{n}{drop\PYZus{}me} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{waterfront}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{df\PYZus{}dropped}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{drop\PYZus{}me}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21082 entries, 0 to 21596
Data columns (total 17 columns):
price              21082 non-null float64
bedrooms           21082 non-null int64
bathrooms          21082 non-null float64
sqft\_living        21082 non-null int64
sqft\_lot           21082 non-null int64
floors             21082 non-null float64
condition          21082 non-null int64
grade              21082 non-null int64
sqft\_above         21082 non-null int64
sqft\_basement      21082 non-null float64
yr\_built           21082 non-null int64
yr\_renovated       17340 non-null float64
zipcode            21082 non-null category
sqft\_living15      21082 non-null int64
sqft\_lot15         21082 non-null int64
code\_view          21082 non-null int8
code\_waterfront    21082 non-null int8
dtypes: category(1), float64(5), int64(9), int8(2)
memory usage: 2.5 MB

    \end{Verbatim}

    \hypertarget{yr_renovated-is_reno}{%
\subsubsection{yr\_renovated --\textgreater{}
is\_reno}\label{yr_renovated-is_reno}}

\begin{itemize}
\tightlist
\item
  yr\_renovated has 3754 null values

  \begin{itemize}
  \tightlist
  \item
    Presumably this is because the homes were never renovated
  \item
    \sout{Will replace with 0.0}
  \item
    Replace all 0.0's with NaN
  \end{itemize}
\item
  Replacing yr\_renovated with binary category based on it if has been
  renovated or not

  \begin{itemize}
  \tightlist
  \item
    Make new column `is\_reno'
  \end{itemize}
\end{itemize}

    \hypertarget{make-is_reno-category-0-or-1}{%
\subparagraph{Make is\_reno category (0 or
1)}\label{make-is_reno-category-0-or-1}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['yr\_renovated']':
dtype: float64
isna: 3742 out of 21082 - 17.75\%

Unique non-na values:
0.0       16618
2014.0       69
2003.0       31
2013.0       31
2007.0       30
2000.0       29
2005.0       29
1990.0       22
2009.0       21
2004.0       21
Name: yr\_renovated, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{} Fill in 0.0 yr\PYZus{}renovated as np.nan temporarily}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Recheck for null values}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)} \PY{c+c1}{\PYZsh{}df.isna().sum()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['yr\_renovated']':
dtype: float64
isna: 20360 out of 21082 - 96.575\%

Unique non-na values:
2014.0    69
2013.0    31
2003.0    31
2007.0    30
2000.0    29
2005.0    29
1990.0    22
2009.0    21
2004.0    21
2006.0    20
Name: yr\_renovated, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{} Get indices of all np.nan values to be used for is\PYZus{}reno category below}
         \PY{n}{idx\PYZus{}nan} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{index}
         \PY{n}{idx\PYZus{}notnan} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{index}
         
         \PY{c+c1}{\PYZsh{} Make df[\PYZsq{}is\PYZus{}reno\PYZsq{}]}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{is\PYZus{}reno}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{is\PYZus{}reno}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx\PYZus{}nan}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{is\PYZus{}reno}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx\PYZus{}notnan}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
         
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{is\PYZus{}reno}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['is\_reno']':
dtype: int64
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
0    20360
1      722
Name: is\_reno, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:7: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  import sys
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}ipykernel\_launcher.py:8: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html\#indexing-view-versus-copy
  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{c+c1}{\PYZsh{} Drop drop\PYZus{}me variable from main df, save in df\PYZus{}dropped}
         \PY{n}{drop\PYZus{}me} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}renovated}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{df\PYZus{}dropped}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{drop\PYZus{}me}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \hypertarget{scrubbing-thus-far}{%
\subsubsection{SCRUBBING THUS FAR\ldots{}}\label{scrubbing-thus-far}}

\begin{itemize}
\item
  Removed null values by dropping na from sqft\_basement and view.
\item
  Converted waterfront to category and made NaN its own separate
  category (since there were so many null vlaues)
\item
  Converted yr\_renovated to is\_reno simple 0 or 1 value
\item
  Recase zipcodes as category since there is no numerical relationship
  between zipcode values
\item
  Next to inspect distributions and scatterplots to identify which
  numerical columns may be better analyzed as categories
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21082 entries, 0 to 21596
Data columns (total 17 columns):
price              21082 non-null float64
bedrooms           21082 non-null int64
bathrooms          21082 non-null float64
sqft\_living        21082 non-null int64
sqft\_lot           21082 non-null int64
floors             21082 non-null float64
condition          21082 non-null int64
grade              21082 non-null int64
sqft\_above         21082 non-null int64
sqft\_basement      21082 non-null float64
yr\_built           21082 non-null int64
zipcode            21082 non-null category
sqft\_living15      21082 non-null int64
sqft\_lot15         21082 non-null int64
code\_view          21082 non-null int8
code\_waterfront    21082 non-null int8
is\_reno            21082 non-null int64
dtypes: category(1), float64(4), int64(10), int8(2)
memory usage: 3.1 MB

    \end{Verbatim}

    \hypertarget{question-1-which-predictors-should-be-analyzed-as-continuous-data-vs-binnedcategorical-data}{%
\subsection{Question 1: Which predictors should be analyzed as
continuous data, vs binned/categorical
data?}\label{question-1-which-predictors-should-be-analyzed-as-continuous-data-vs-binnedcategorical-data}}

\hypertarget{identifying-numerical-data-better-analyzed-as-categorical}{%
\paragraph{Identifying numerical data better analyzed as
categorical}\label{identifying-numerical-data-better-analyzed-as-categorical}}

\begin{itemize}
\tightlist
\item
  Will examine histogram distributions and scatter plots vs price for
  each variable in df.describe()
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{c+c1}{\PYZsh{} Plot histograms and scatterplots vs target variable price for all numerical columns in df (show up in .describe())}
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plot\PYZus{}hist\PYZus{}scat}\PY{p}{(}\PY{n}{df}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} fig = plot\PYZus{}hist\PYZus{}scat\PYZus{}sns(df)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_15.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{answer-1-how-to-treat-each-variable}{%
\subsubsection{Answer 1: How to treat each
variable}\label{answer-1-how-to-treat-each-variable}}

\begin{itemize}
\tightlist
\item
  Notes on histograms and scatterplots \#\#\#\# First, to comment on
  scatter plots that are indicative of categorical data:
\item
  \textbf{Columns to be analyzed as categorical data:} (cast as int for
  now, make sure its .\sout{astype(`category').cat.as\_ordered()}
  one-hot coded later before running regression

  \begin{itemize}
  \tightlist
  \item
    Waterfront
  \item
    View
  \item
    Zipcode
  \end{itemize}
\item
  \textbf{Columns that are ordinal data.} (e.g.~2 floors is indeed
  double 1 floor)

  \begin{itemize}
  \tightlist
  \item
    Floors
  \item
    Bedrooms
  \item
    Bathrooms
  \item
    Condition
  \item
    Grade
  \end{itemize}
\item
  \textbf{Columns that may be best analyzed by binning and casting as
  categorical data}

  \begin{itemize}
  \tightlist
  \item
    Yr\_built
  \item
    is\_reno

    \begin{itemize}
    \tightlist
    \item
      classified as simply renovated or not.**
    \end{itemize}
  \item
    sqft\_basement
  \item
    sqft\_above
  \end{itemize}
\item
  \textbf{Numerical columns} (that may be best analyzed as such)

  \begin{itemize}
  \tightlist
  \item
    All sqft categories
  \item
    price
  \item
    Note: moved sqft\_basement to binned category to deal with 0's, also
    added sqft\_above to accompany it
  \end{itemize}
\item
  \textbf{Numerical columns that were dropped}

  \begin{itemize}
  \tightlist
  \item
    id
  \item
    Lat
  \item
    Long
  \item
    Date
  \item
    yr\_renovated -\textgreater{} is\_reno
  \end{itemize}
\end{itemize}

\hypertarget{second-to-comment-on-distributions}{%
\paragraph{Second, to comment on
distributions}\label{second-to-comment-on-distributions}}

\begin{itemize}
\tightlist
\item
  The target variable, price, seems a bit skewed and \emph{may} be
  better analyzed as log-transformed.

  \begin{itemize}
  \tightlist
  \item
    Try both log-transformed and unaltered
  \end{itemize}
\item
  All sqft columns seem to be skewed and should be transformed. (log)
\end{itemize}

    \hypertarget{list-of-vartypesnames}{%
\subsubsection{List of vartypes/names}\label{list-of-vartypesnames}}

    \begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Create tuples with columns names of categorical variables for easy extraction }
\NormalTok{cat_vars }\OperatorTok{=}\NormalTok{ (}\StringTok{'waterfront'}\NormalTok{,}\StringTok{'view'}\NormalTok{,}\StringTok{'zipcode'}\NormalTok{)}
\NormalTok{ord_vars }\OperatorTok{=}\NormalTok{ (}\StringTok{'grade'}\NormalTok{,}\StringTok{'condition'}\NormalTok{,}\StringTok{'floors'}\NormalTok{,}\StringTok{'bedrooms'}\NormalTok{,}\StringTok{'bathrooms'}\NormalTok{)}
\NormalTok{vars_to_bin }\OperatorTok{=}\NormalTok{ (}\StringTok{'yr_built'}\NormalTok{,}\StringTok{'yr_renovated'}\NormalTok{,}\StringTok{'sqft_above'}\NormalTok{,}\StringTok{'sqft_basement'}\NormalTok{)}
\NormalTok{num_vars }\OperatorTok{=}\NormalTok{ (}\StringTok{'sqft_living'}\NormalTok{, }\StringTok{'sqft_lot'}\NormalTok{,}\StringTok{'sqft_living15'}\NormalTok{, }\StringTok{'sqft_lot15'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

    \hypertarget{coarse-binning-numerical-data}{%
\subsection{COARSE-BINNING Numerical
Data}\label{coarse-binning-numerical-data}}

\begin{itemize}
\tightlist
\item
  yr\_built, yr\_renovated
\item
  Added sqft\_basement due to 0 values
\item
  Added sqft\_above to accompany basement
\end{itemize}

    \hypertarget{binning-yr_built}{%
\subsubsection{binning yr\_built}\label{binning-yr_built}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{c+c1}{\PYZsh{} Check the min and max of the yr variables for binning range}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}built}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} count    21082.000000
         mean      1971.023337
         std         29.323120
         min       1900.000000
         25\%       1952.000000
         50\%       1975.000000
         75\%       1997.000000
         max       2015.000000
         Name: yr\_built, dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Bin yr\PYZus{}built then make yr\PYZus{}built category}
         \PY{c+c1}{\PYZsh{} yr\PYZus{}built min is 1900, max is 2015}
         \PY{n}{bins} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1900}\PY{p}{,}\PY{l+m+mi}{2030}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}built}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{bins\PYZus{}yrbuilt} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}built}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{bins}\PY{p}{,}\PY{n}{include\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)} \PY{c+c1}{\PYZsh{} Cut into bins}
         \PY{c+c1}{\PYZsh{} check\PYZus{}column(bins\PYZus{}yrbuilt)}
         
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}yrbuilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{bins\PYZus{}yrbuilt}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{as\PYZus{}ordered}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{}.cat.as\PYZus{}ordered()}
         
         \PY{c+c1}{\PYZsh{} Inspecting the binned data counts}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}yrbuilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['bins\_yrbuilt']':
dtype: category
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
(2000.0, 2010.0]      3354
(1960.0, 1970.0]      2484
(1950.0, 1960.0]      2411
(1970.0, 1980.0]      2351
(1980.0, 1990.0]      2297
(1990.0, 2000.0]      2085
(1940.0, 1950.0]      1806
(1920.0, 1930.0]      1142
(2010.0, 2020.0]      1066
(1899.999, 1910.0]     759
(1910.0, 1920.0]       747
(1930.0, 1940.0]       580
Name: bins\_yrbuilt, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{c+c1}{\PYZsh{} Drop original }
         \PY{n}{drop\PYZus{}me} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr\PYZus{}built}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{df\PYZus{}dropped}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{drop\PYZus{}me}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \hypertarget{binning-sqft_basement}{%
\subsubsection{binning sqft\_basement}\label{binning-sqft_basement}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}38}]:} count    21082.000000
         mean       291.359975
         std        442.007858
         min          0.000000
         25\%          0.000000
         50\%          0.000000
         75\%        560.000000
         max       4820.000000
         Name: sqft\_basement, dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['sqft\_basement']':
dtype: float64
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
0.0       12798
600.0       216
500.0       209
700.0       207
800.0       201
400.0       184
1000.0      147
900.0       142
300.0       140
200.0       105
Name: sqft\_basement, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{c+c1}{\PYZsh{} Definine bins where bins 0\PYZhy{}1 is its own interval}
         \PY{n}{bins}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{inf}\PY{p}{]}
         \PY{p}{[}\PY{n}{bins}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} bins}
         
         \PY{c+c1}{\PYZsh{} cut\PYZus{}basement = df[\PYZsq{}sqft\PYZus{}basement\PYZsq{}].replace(0,np.nan)}
         \PY{n}{cut\PYZus{}basement} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} cut\PYZus{}basement = cut\PYZus{}basement.replace(\PYZsq{}NaN\PYZsq{},0)}
         
         \PY{n}{bins\PYZus{}sqftbase} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{cut\PYZus{}basement}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{n}{bins}\PY{p}{,} \PY{n}{include\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)} \PY{c+c1}{\PYZsh{} Cut into bins}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{bins\PYZus{}sqftbase}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Cast as ordered category}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{as\PYZus{}ordered}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Check result}
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['bins\_sqftbasement']':
dtype: category
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
(-inf, 1.0]         12798
(501.0, 1001.0]      3849
(1.0, 501.0]         2617
(1001.0, 1501.0]     1476
(1501.0, 2001.0]      269
(2001.0, 2501.0]       57
(2501.0, 3001.0]       11
(3001.0, 3501.0]        3
(4501.0, 5001.0]        1
(4001.0, 4501.0]        1
(3501.0, 4001.0]        0
Name: bins\_sqftbasement, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{c+c1}{\PYZsh{} Drop original }
         \PY{n}{drop\PYZus{}me} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}basement}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{df\PYZus{}dropped}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{drop\PYZus{}me}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \hypertarget{binning-sqft_above}{%
\subsubsection{binning sqft\_above}\label{binning-sqft_above}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}above}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}above}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['sqft\_above']':
dtype: int64
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
1300    208
1010    206
1200    197
1220    190
1140    181
1180    174
1400    174
1340    173
1060    173
1250    168
Name: sqft\_above, dtype: int64

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:} count    21082.000000
         mean      1789.000000
         std        828.369355
         min        370.000000
         25\%       1200.000000
         50\%       1560.000000
         75\%       2210.000000
         max       9410.000000
         Name: sqft\_above, dtype: float64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{c+c1}{\PYZsh{} sqft\PYZus{}above }
         \PY{c+c1}{\PYZsh{} Bins to cover range seen above in .describe}
         \PY{n}{bins} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{9501}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} cut\PYZus{}above = df[\PYZsq{}sqft\PYZus{}above\PYZsq{}].replace(0,np.nan)}
         \PY{n}{bins\PYZus{}sqftabove} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}above}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{n}{bins}\PY{p}{,} \PY{n}{include\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)} \PY{c+c1}{\PYZsh{} Cut into bins, including left edge }
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{bins\PYZus{}sqftabove}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['sqft\_above']':
dtype: category
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
(1000.0, 1500.0]    7352
(1500.0, 2000.0]    4686
(2000.0, 2500.0]    2764
(500.0, 1000.0]     2488
(2500.0, 3000.0]    1815
(3000.0, 3500.0]    1088
(3500.0, 4000.0]     466
(4000.0, 4500.0]     239
(4500.0, 5000.0]      80
(5000.0, 5500.0]      42
(-0.001, 500.0]       19
(6000.0, 6500.0]      16
(5500.0, 6000.0]      14
(6500.0, 7000.0]       4
(7500.0, 8000.0]       3
(8500.0, 9000.0]       2
(7000.0, 7500.0]       2
(8000.0, 8500.0]       1
(9000.0, 9500.0]       1
Name: sqft\_above, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{bins\PYZus{}sqftabove}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NaN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftabove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{bins\PYZus{}sqftabove}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{as\PYZus{}ordered}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{check\PYZus{}column}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftabove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Column: df['bins\_sqftabove']':
dtype: category
isna: 0 out of 21082 - 0.0\%

Unique non-na values:
(1000.0, 1500.0]    7352
(1500.0, 2000.0]    4686
(2000.0, 2500.0]    2764
(500.0, 1000.0]     2488
(2500.0, 3000.0]    1815
(3000.0, 3500.0]    1088
(3500.0, 4000.0]     466
(4000.0, 4500.0]     239
(4500.0, 5000.0]      80
(5000.0, 5500.0]      42
(-0.001, 500.0]       19
(6000.0, 6500.0]      16
(5500.0, 6000.0]      14
(6500.0, 7000.0]       4
(7500.0, 8000.0]       3
(8500.0, 9000.0]       2
(7000.0, 7500.0]       2
(8000.0, 8500.0]       1
(9000.0, 9500.0]       1
Name: bins\_sqftabove, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{c+c1}{\PYZsh{} Drop original }
         \PY{n}{drop\PYZus{}me} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}above}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{df\PYZus{}dropped}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{drop\PYZus{}me}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{drop\PYZus{}me}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \hypertarget{checking-for-multicollinearity}{%
\subsection{CHECKING FOR
MULTICOLLINEARITY}\label{checking-for-multicollinearity}}

\hypertarget{question-2which-predictors-are-closely-related-and-should-be-dropped}{%
\subsubsection{Question 2:Which predictors are closely related and
should be
dropped?}\label{question-2which-predictors-are-closely-related-and-should-be-dropped}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21082 entries, 0 to 21596
Data columns (total 17 columns):
price                21082 non-null float64
bedrooms             21082 non-null int64
bathrooms            21082 non-null float64
sqft\_living          21082 non-null int64
sqft\_lot             21082 non-null int64
floors               21082 non-null float64
condition            21082 non-null int64
grade                21082 non-null int64
zipcode              21082 non-null category
sqft\_living15        21082 non-null int64
sqft\_lot15           21082 non-null int64
code\_view            21082 non-null int8
code\_waterfront      21082 non-null int8
is\_reno              21082 non-null int64
bins\_yrbuilt         21082 non-null category
bins\_sqftbasement    21082 non-null category
bins\_sqftabove       21082 non-null category
dtypes: category(4), float64(3), int64(8), int8(2)
memory usage: 2.7 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{c+c1}{\PYZsh{} to\PYZus{}drop\PYZus{}copy = [\PYZsq{}sqft\PYZus{}above\PYZsq{},\PYZsq{}sqft\PYZus{}basement\PYZsq{},\PYZsq{}yr\PYZus{}built\PYZsq{},\PYZsq{}waterfront\PYZsq{},\PYZsq{}view\PYZsq{}]}
         \PY{c+c1}{\PYZsh{} df\PYZus{}dropped = df[to\PYZus{}drop\PYZus{}copy].copy()}
         \PY{c+c1}{\PYZsh{} \PYZsh{} df.drop(to\PYZus{}drop\PYZus{}copy,axis=1,inplace=True)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{c+c1}{\PYZsh{} Plot correlation  heatmaps for all data }
         \PY{c+c1}{\PYZsh{} pause}
         \PY{n}{to\PYZus{}drop} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{multiplot}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{to\PYZus{}drop}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_79_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} Test which multicol variables to keep}
         \PY{c+c1}{\PYZsh{} pause}
         \PY{c+c1}{\PYZsh{} df[[\PYZsq{}price\PYZsq{},\PYZsq{}sqft\PYZus{}living\PYZsq{},\PYZsq{}sqft\PYZus{}living15\PYZsq{},\PYZsq{}sqft\PYZus{}above\PYZsq{},\PYZsq{}sqft\PYZus{}basement\PYZsq{}]].corr()}
\end{Verbatim}


    \hypertarget{answer-2}{%
\subsubsection{Answer 2:}\label{answer-2}}

\begin{itemize}
\tightlist
\item
  Sqft\_living is highly correlated with sqft\_living15 and grade,
\item
  These correlations make sense sense since neighborhoods probably have
  similar construction.

  \begin{itemize}
  \tightlist
  \item
    The r values are \textasciitilde{}0.75 (threshold) and have
    sufficient intuitive rationale to keep.
  \end{itemize}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} Save copy of data in current form.}
         \PY{c+c1}{\PYZsh{} df.to\PYZus{}csv(\PYZsq{}scrubbed\PYZus{}data.csv\PYZsq{})}
         \PY{c+c1}{\PYZsh{} df\PYZus{}dropped.to\PYZus{}csv(\PYZsq{}dropped\PYZus{}data.csv\PYZsq{})}
\end{Verbatim}


    \hypertarget{explore}{%
\section{EXPLORE:}\label{explore}}

\begin{itemize}
\tightlist
\item
  Re-examining the basic stats and distributions of the data.
\item
  Decide on transformations to perform

  \begin{itemize}
  \tightlist
  \item
    Normalize afterwards.
  \end{itemize}
\item
  Visually examine for possible relationships
\end{itemize}

    \hypertarget{eda-before-normalizationtransformation}{%
\subsection{EDA before
normalization/transformation}\label{eda-before-normalizationtransformation}}

    \hypertarget{examine-basic-descriptive-stats}{%
\subsubsection{Examine basic descriptive
stats}\label{examine-basic-descriptive-stats}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21082 entries, 0 to 21596
Data columns (total 17 columns):
price                21082 non-null float64
bedrooms             21082 non-null int64
bathrooms            21082 non-null float64
sqft\_living          21082 non-null int64
sqft\_lot             21082 non-null int64
floors               21082 non-null float64
condition            21082 non-null int64
grade                21082 non-null int64
zipcode              21082 non-null category
sqft\_living15        21082 non-null int64
sqft\_lot15           21082 non-null int64
code\_view            21082 non-null int8
code\_waterfront      21082 non-null int8
is\_reno              21082 non-null int64
bins\_yrbuilt         21082 non-null category
bins\_sqftbasement    21082 non-null category
bins\_sqftabove       21082 non-null category
dtypes: category(4), float64(3), int64(8), int8(2)
memory usage: 2.7 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}52}]:}       price  bedrooms  bathrooms  sqft\_living  sqft\_lot  floors  condition  \textbackslash{}
         0  221900.0         3       1.00         1180      5650     1.0          3   
         1  538000.0         3       2.25         2570      7242     2.0          3   
         2  180000.0         2       1.00          770     10000     1.0          3   
         3  604000.0         4       3.00         1960      5000     1.0          5   
         4  510000.0         3       2.00         1680      8080     1.0          3   
         
            grade zipcode  sqft\_living15  sqft\_lot15  code\_view  code\_waterfront  \textbackslash{}
         0      7   98178           1340        5650          0                2   
         1      7   98125           1690        7639          0                0   
         2      6   98028           2720        8062          0                0   
         3      7   98136           1360        5000          0                0   
         4      8   98074           1800        7503          0                0   
         
            is\_reno      bins\_yrbuilt bins\_sqftbasement    bins\_sqftabove  
         0        0  (1950.0, 1960.0]       (-inf, 1.0]  (1000.0, 1500.0]  
         1        1  (1950.0, 1960.0]      (1.0, 501.0]  (2000.0, 2500.0]  
         2        0  (1930.0, 1940.0]       (-inf, 1.0]   (500.0, 1000.0]  
         3        0  (1960.0, 1970.0]   (501.0, 1001.0]  (1000.0, 1500.0]  
         4        0  (1980.0, 1990.0]       (-inf, 1.0]  (1500.0, 2000.0]  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}53}]:}               price      bedrooms     bathrooms   sqft\_living      sqft\_lot  \textbackslash{}
         count  2.108200e+04  21082.000000  21082.000000  21082.000000  2.108200e+04   
         mean   5.402469e+05      3.372403      2.115916   2080.359975  1.507759e+04   
         std    3.667323e+05      0.924996      0.768142    917.856396  4.117338e+04   
         min    7.800000e+04      1.000000      0.500000    370.000000  5.200000e+02   
         25\%    3.220000e+05      3.000000      1.750000   1430.000000  5.040000e+03   
         50\%    4.500000e+05      3.000000      2.250000   1910.000000  7.620000e+03   
         75\%    6.450000e+05      4.000000      2.500000   2550.000000  1.069775e+04   
         max    7.700000e+06     33.000000      8.000000  13540.000000  1.651359e+06   
         
                     floors     condition         grade  sqft\_living15     sqft\_lot15  \textbackslash{}
         count  21082.00000  21082.000000  21082.000000   21082.000000   21082.000000   
         mean       1.49362      3.409828      7.657717    1986.917418   12732.514135   
         std        0.53937      0.650597      1.173690     685.544250   27148.781580   
         min        1.00000      1.000000      3.000000     399.000000     651.000000   
         25\%        1.00000      3.000000      7.000000    1490.000000    5100.000000   
         50\%        1.50000      3.000000      7.000000    1840.000000    7626.000000   
         75\%        2.00000      4.000000      8.000000    2360.000000   10088.750000   
         max        3.50000      5.000000     13.000000    6210.000000  871200.000000   
         
                   code\_view  code\_waterfront       is\_reno  
         count  21082.000000     21082.000000  21082.000000  
         mean       0.233327         0.228014      0.034247  
         std        0.765066         0.630372      0.181868  
         min        0.000000         0.000000      0.000000  
         25\%        0.000000         0.000000      0.000000  
         50\%        0.000000         0.000000      0.000000  
         75\%        0.000000         0.000000      0.000000  
         max        4.000000         2.000000      1.000000  
\end{Verbatim}
            
    \hypertarget{notes-on-basic-statistics}{%
\paragraph{Notes on basic statistics}\label{notes-on-basic-statistics}}

\begin{itemize}
\tightlist
\item
  Bedrooms has some very clear outliers (max is 33, but 75\% quartile is
  only 4)

  \begin{itemize}
  \tightlist
  \item
    May want to remove outliers after Z-scoring (Absolute Z-score
    \textgreater{} 3)
  \end{itemize}
\item
  Same with bathrooms (8 is max, 75\% quartile is only 2.5)
\item
  Same with sqft\_living (max 13540, 75\% quartile = 2550)
\item
  Also same with sqft\_lot15, sqftliving15
\end{itemize}

    \hypertarget{visualizing-numerical-data}{%
\subsubsection{Visualizing numerical
data}\label{visualizing-numerical-data}}

\begin{itemize}
\tightlist
\item
  Distributions and scatterplots
\item
  Note: May want to cast all categoricals as strings/categories for
  visualization

  \begin{itemize}
  \tightlist
  \item
    Keeping as is for now
  \end{itemize}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{c+c1}{\PYZsh{} Separate out numerical }
         \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}54}]:}               price      bedrooms     bathrooms   sqft\_living      sqft\_lot  \textbackslash{}
         count  2.108200e+04  21082.000000  21082.000000  21082.000000  2.108200e+04   
         mean   5.402469e+05      3.372403      2.115916   2080.359975  1.507759e+04   
         std    3.667323e+05      0.924996      0.768142    917.856396  4.117338e+04   
         min    7.800000e+04      1.000000      0.500000    370.000000  5.200000e+02   
         25\%    3.220000e+05      3.000000      1.750000   1430.000000  5.040000e+03   
         50\%    4.500000e+05      3.000000      2.250000   1910.000000  7.620000e+03   
         75\%    6.450000e+05      4.000000      2.500000   2550.000000  1.069775e+04   
         max    7.700000e+06     33.000000      8.000000  13540.000000  1.651359e+06   
         
                     floors     condition         grade  sqft\_living15     sqft\_lot15  \textbackslash{}
         count  21082.00000  21082.000000  21082.000000   21082.000000   21082.000000   
         mean       1.49362      3.409828      7.657717    1986.917418   12732.514135   
         std        0.53937      0.650597      1.173690     685.544250   27148.781580   
         min        1.00000      1.000000      3.000000     399.000000     651.000000   
         25\%        1.00000      3.000000      7.000000    1490.000000    5100.000000   
         50\%        1.50000      3.000000      7.000000    1840.000000    7626.000000   
         75\%        2.00000      4.000000      8.000000    2360.000000   10088.750000   
         max        3.50000      5.000000     13.000000    6210.000000  871200.000000   
         
                   code\_view  code\_waterfront       is\_reno  
         count  21082.000000     21082.000000  21082.000000  
         mean       0.233327         0.228014      0.034247  
         std        0.765066         0.630372      0.181868  
         min        0.000000         0.000000      0.000000  
         25\%        0.000000         0.000000      0.000000  
         50\%        0.000000         0.000000      0.000000  
         75\%        0.000000         0.000000      0.000000  
         max        4.000000         2.000000      1.000000  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{c+c1}{\PYZsh{} INSPECTING NUMERICAL DATA DISTPLOTS + KDE}
         \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seaborn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
             
             \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{,}\PY{n}{kde}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{label} \PY{o}{=} \PY{n}{column}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ histogram}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{norm\PYZus{}hist}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{title} \PY{o}{=} \PY{n}{column}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ histogram \PYZam{} KDE}\PY{l+s+s1}{\PYZsq{}}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{title}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Uncomment below if want new scatter\PYZus{}matrix}
         \PY{c+c1}{\PYZsh{} fig = pd.plotting.scatter\PYZus{}matrix(df\PYZus{}clean,figsize=(12,12))}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{notes-on-distplots}{%
\paragraph{Notes on distplots}\label{notes-on-distplots}}

\begin{itemize}
\tightlist
\item
  Essentialy all numerical data seems to be at least slightly skewed.

  \begin{itemize}
  \tightlist
  \item
    Do not think it is sufficient to log-transform the data and lose
    model interpretability
  \end{itemize}
\end{itemize}

    \hypertarget{visualizing-categorical-data}{%
\subsubsection{Visualizing categorical
data}\label{visualizing-categorical-data}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21082 entries, 0 to 21596
Data columns (total 17 columns):
price                21082 non-null float64
bedrooms             21082 non-null int64
bathrooms            21082 non-null float64
sqft\_living          21082 non-null int64
sqft\_lot             21082 non-null int64
floors               21082 non-null float64
condition            21082 non-null int64
grade                21082 non-null int64
zipcode              21082 non-null category
sqft\_living15        21082 non-null int64
sqft\_lot15           21082 non-null int64
code\_view            21082 non-null int8
code\_waterfront      21082 non-null int8
is\_reno              21082 non-null int64
bins\_yrbuilt         21082 non-null category
bins\_sqftbasement    21082 non-null category
bins\_sqftabove       21082 non-null category
dtypes: category(4), float64(3), int64(8), int8(2)
memory usage: 2.7 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{c+c1}{\PYZsh{} Define list of all categorical variables }
         \PY{n}{list\PYZus{}cat\PYZus{}vars} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}yrbuilt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}sqftabove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{condition}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grade}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code\PYZus{}view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code\PYZus{}waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{c+c1}{\PYZsh{} Plotting scatterplots and boxplots for categorical data}
         \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seaborn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{list\PYZus{}cat\PYZus{}vars}\PY{p}{:}
            
             \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{ax1}  \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
             \PY{n}{ax1} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{stripplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
             \PY{c+c1}{\PYZsh{} ax1.set\PYZus{}title(\PYZsq{}Price vs \PYZsq{},column,\PYZsq{} scatter plot\PYZsq{})}
             \PY{n}{title1}\PY{o}{=}\PY{n}{column}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ scatter}\PY{l+s+s1}{\PYZsq{}}
             \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title1}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{column}\PY{p}{)}
             \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             
             \PY{n}{ax2} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
             \PY{n}{ax2} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} 
             \PY{n}{title2}\PY{o}{=}\PY{n}{column}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ boxplot}\PY{l+s+s1}{\PYZsq{}}
             \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title2}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{column}\PY{p}{)}
             \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{questionanswer-3a-which-categorical-variables-show-the-greatest-potential-as-predictors}{%
\subsubsection{Question/Answer 3A: Which categorical variables show the
greatest potential as
predictors?}\label{questionanswer-3a-which-categorical-variables-show-the-greatest-potential-as-predictors}}

\hypertarget{answer-3a}{%
\paragraph{ANSWER 3A:}\label{answer-3a}}

\textbf{Notes on categorical scatter plots} - grade seems to be strongly
related to price (notice how the whole range of values seems to increase
in price at higher grades. - Zipcodes look to differ quite a bit in
terms of price. - Condition looks to be highly related to price (at
least above condition level 2) - View does not look as strongly related
to price as I expected. - Floors do not seem as related as expected -
yr\_built may have some relationship with price - yr\_renovated has
somewhat of a trend, but recent renovations buck this trend

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} INSPECTING REGRESSION PLOTS}
         \PY{c+c1}{\PYZsh{} plt.style.use(\PYZsq{}seaborn\PYZsq{})}
         
         \PY{c+c1}{\PYZsh{} plot\PYZus{}vars=df.describe().columns}
         
         \PY{c+c1}{\PYZsh{} for column in plot\PYZus{}vars:}
         \PY{c+c1}{\PYZsh{} \PYZsh{}     df\PYZus{}plot=df[column]}
         \PY{c+c1}{\PYZsh{} \PYZsh{}     df\PYZus{}plot = df.loc[df[column]\PYZgt{}0]}
         \PY{c+c1}{\PYZsh{}     plot= sns.regplot(df[column], df[\PYZsq{}price\PYZsq{}],robust=False,marker=\PYZsq{}.\PYZsq{}) \PYZsh{}kde=True,label = column+\PYZsq{} histogram\PYZsq{})}
         \PY{c+c1}{\PYZsh{} \PYZsh{}     plot = sns.boxplot(df[column],df[\PYZsq{}price\PYZsq{}])}
         \PY{c+c1}{\PYZsh{}     title = column+\PYZsq{} linear regression\PYZsq{}}
         \PY{c+c1}{\PYZsh{}     plt.title(title.title())}
         \PY{c+c1}{\PYZsh{} \PYZsh{}     plt.legend()}
         \PY{c+c1}{\PYZsh{}     plt.show()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}60}]:}               price      bedrooms     bathrooms   sqft\_living      sqft\_lot  \textbackslash{}
         count  2.108200e+04  21082.000000  21082.000000  21082.000000  2.108200e+04   
         mean   5.402469e+05      3.372403      2.115916   2080.359975  1.507759e+04   
         std    3.667323e+05      0.924996      0.768142    917.856396  4.117338e+04   
         min    7.800000e+04      1.000000      0.500000    370.000000  5.200000e+02   
         25\%    3.220000e+05      3.000000      1.750000   1430.000000  5.040000e+03   
         50\%    4.500000e+05      3.000000      2.250000   1910.000000  7.620000e+03   
         75\%    6.450000e+05      4.000000      2.500000   2550.000000  1.069775e+04   
         max    7.700000e+06     33.000000      8.000000  13540.000000  1.651359e+06   
         
                     floors     condition         grade  sqft\_living15     sqft\_lot15  \textbackslash{}
         count  21082.00000  21082.000000  21082.000000   21082.000000   21082.000000   
         mean       1.49362      3.409828      7.657717    1986.917418   12732.514135   
         std        0.53937      0.650597      1.173690     685.544250   27148.781580   
         min        1.00000      1.000000      3.000000     399.000000     651.000000   
         25\%        1.00000      3.000000      7.000000    1490.000000    5100.000000   
         50\%        1.50000      3.000000      7.000000    1840.000000    7626.000000   
         75\%        2.00000      4.000000      8.000000    2360.000000   10088.750000   
         max        3.50000      5.000000     13.000000    6210.000000  871200.000000   
         
                   code\_view  code\_waterfront       is\_reno  
         count  21082.000000     21082.000000  21082.000000  
         mean       0.233327         0.228014      0.034247  
         std        0.765066         0.630372      0.181868  
         min        0.000000         0.000000      0.000000  
         25\%        0.000000         0.000000      0.000000  
         50\%        0.000000         0.000000      0.000000  
         75\%        0.000000         0.000000      0.000000  
         max        4.000000         2.000000      1.000000  
\end{Verbatim}
            
    \hypertarget{scrub-2-normalizing-transforming}{%
\section{{[}SCRUB-2{]} NORMALIZING \&
TRANSFORMING}\label{scrub-2-normalizing-transforming}}

\textbf{Graphing raw vs normalized results to decide if dataset should
be normalized} - \sout{log-transform and z-score numerical data.}\\
- Am using detect\_outlier function to apply Tukey's method for outlier
remnoval based on IQR

    \hypertarget{outlier-removal---visualizing}{%
\subsection{Outlier Removal -
visualizing}\label{outlier-removal---visualizing}}

    \begin{itemize}
\tightlist
\item
  Will be using pre-defined function detect\_outliers(df,n,var\_name)

  \begin{itemize}
  \tightlist
  \item
    Returns index of rows containing outliers based in IQR
  \end{itemize}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 21082 entries, 0 to 21596
Data columns (total 17 columns):
price                21082 non-null float64
bedrooms             21082 non-null int64
bathrooms            21082 non-null float64
sqft\_living          21082 non-null int64
sqft\_lot             21082 non-null int64
floors               21082 non-null float64
condition            21082 non-null int64
grade                21082 non-null int64
zipcode              21082 non-null category
sqft\_living15        21082 non-null int64
sqft\_lot15           21082 non-null int64
code\_view            21082 non-null int8
code\_waterfront      21082 non-null int8
is\_reno              21082 non-null int64
bins\_yrbuilt         21082 non-null category
bins\_sqftbasement    21082 non-null category
bins\_sqftabove       21082 non-null category
dtypes: category(4), float64(3), int64(8), int8(2)
memory usage: 2.7 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{} Define variables to plot vs tukey\PYZhy{}cleaned outliers }
         \PY{n}{vars\PYZus{}to\PYZus{}norm} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}lot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}lot15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:} Index(['price', 'bedrooms', 'bathrooms', 'sqft\_living', 'sqft\_lot', 'floors',
                'condition', 'grade', 'sqft\_living15', 'sqft\_lot15', 'code\_view',
                'code\_waterfront', 'is\_reno'],
               dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{Counter}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{RobustScaler}
         \PY{n}{robscaler} \PY{o}{=} \PY{n}{RobustScaler}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} vars\PYZus{}to\PYZus{}norm = [\PYZsq{}sqft\PYZus{}living\PYZsq{},\PYZsq{}sqft\PYZus{}lot\PYZsq{},\PYZsq{}sqft\PYZus{}living15\PYZsq{},\PYZsq{}sqft\PYZus{}lot15\PYZsq{},\PYZsq{}bedrooms\PYZsq{},\PYZsq{}bathrooms\PYZsq{}]}
         \PY{n}{norm\PYZus{}results} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{column}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{K\PYZus{}square}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}val}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Graph all potential normalizedvariables}
         \PY{k}{for} \PY{n}{var\PYZus{}name} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{:}
         
             \PY{n}{var} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{var\PYZus{}name}\PY{p}{]}
             \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
             \PY{n}{ax1} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
             \PY{n}{ax1} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{var}\PY{p}{,} \PY{n}{norm\PYZus{}hist}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)} 
             \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Raw }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{var\PYZus{}name}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}robscaler.fit\PYZus{}transform(np.array(var).reshape(\PYZhy{}1,1)}
             
             \PY{c+c1}{\PYZsh{} OUTLIER REMOVAL}
             \PY{n}{outliers\PYZus{}to\PYZus{}drop} \PY{o}{=} \PY{n}{detect\PYZus{}outliers}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{[}\PY{n}{var\PYZus{}name}\PY{p}{]}\PY{p}{)}
             \PY{n}{var\PYZus{}clean} \PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{n}{var\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{outliers\PYZus{}to\PYZus{}drop}\PY{p}{)}
             
             \PY{n}{ax2} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
             
             \PY{n}{ax2} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{var\PYZus{}clean}\PY{p}{,}\PY{n}{norm\PYZus{}hist}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}     ax2 = sns.distplot(robscaler.fit\PYZus{}transform(np.array(var\PYZus{}clean).reshape(\PYZhy{}1,1)),norm\PYZus{}hist=True)}
             
             \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tukey Outliers Removed }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{var\PYZus{}name}\PY{p}{)} \PY{c+c1}{\PYZsh{}+var)}
             \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{stat}\PY{p}{,} \PY{n}{p} \PY{o}{=} \PY{n}{normtest}\PY{p}{(}\PY{n}{var\PYZus{}clean}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}     norm\PYZus{}results.append([var\PYZus{}clean,stat, p])}
         \PY{c+c1}{\PYZsh{} norm\PYZus{}results = pd.DataFrame(norm\PYZus{}results[2:],columns=norm\PYZus{}results[0])\PYZsh{},index=\PYZsq{}columns\PYZsq{})}
         \PY{c+c1}{\PYZsh{} norm\PYZus{}results}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}nonparametric\textbackslash{}kde.py:488: RuntimeWarning: invalid value encountered in true\_divide
  binned = fast\_linbin(X, a, b, gridsize) / (delta * nobs)
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}nonparametric\textbackslash{}kdetools.py:34: RuntimeWarning: invalid value encountered in double\_scalars
  FAC1 = 2*(np.pi*bw/RANGE)**2
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}numpy\textbackslash{}core\textbackslash{}fromnumeric.py:83: RuntimeWarning: invalid value encountered in reduce
  return ufunc.reduce(obj, axis, dtype, out, **passkwargs)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{questionanswer-3b-does-removal-of-outliers-improve-the-distrubtions}{%
\subsubsection{Question/Answer 3B: Does removal of outliers improve the
distrubtions?}\label{questionanswer-3b-does-removal-of-outliers-improve-the-distrubtions}}

\begin{itemize}
\tightlist
\item
  The data is skewed by outliers.

  \begin{itemize}
  \tightlist
  \item
    Comparing it to IQR-method outlier elimination reveals much improved
    results
  \item
    The distributions look much more reasonabile with outliers removed.
  \end{itemize}
\end{itemize}

    \hypertarget{removing-outliers}{%
\subsection{REMOVING OUTLIERS}\label{removing-outliers}}

    \hypertarget{recall-stats-observations-from-beginning-of-eda}{%
\paragraph{Recall stats observations from beginning of
EDA:}\label{recall-stats-observations-from-beginning-of-eda}}

\begin{quote}
\mbox{}%
\hypertarget{notes-on-basic-statistics}{%
\paragraph{Notes on basic statistics}\label{notes-on-basic-statistics}}

\begin{itemize}
\tightlist
\item
  Bedrooms has some very clear outliers (max is 33, but 75\% quartile is
  only 4)

  \begin{itemize}
  \tightlist
  \item
    May want to remove outliers after Z-scoring (Absolute Z-score
    \textgreater{} 3)
  \end{itemize}
\item
  Same with bathrooms (8 is max, 75\% quartile is only 2.5)
\item
  Same with sqft\_living (max 13540, 75\% quartile = 2550)
\item
  Also same with sqft\_lot15, sqftliving15
\end{itemize}
\end{quote}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{c+c1}{\PYZsh{} DEFINE VARIABLES TO GET THE OUTLIERS FOR (based on observations)}
         \PY{c+c1}{\PYZsh{} vars\PYZus{}to\PYZus{}norm = [\PYZsq{}price\PYZsq{},\PYZsq{}bedrooms\PYZsq{}\PYZsq{}sqft\PYZus{}living\PYZsq{},\PYZsq{}sqft\PYZus{}lot\PYZsq{},\PYZsq{}sqft\PYZus{}living15\PYZsq{},\PYZsq{}sqft\PYZus{}lot15\PYZsq{},\PYZsq{}bedrooms\PYZsq{},\PYZsq{}bathrooms\PYZsq{}}
         \PY{n}{vars\PYZus{}to\PYZus{}clean} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{} GET OUTLIER INDICES AND REPORT }
         
         \PY{n}{outliers\PYZus{}to\PYZus{}drop} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{vars\PYZus{}to\PYZus{}clean}\PY{p}{:}
             \PY{n}{outliers\PYZus{}to\PYZus{}drop}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{detect\PYZus{}outliers}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} outliers\PYZus{}to\PYZus{}drop.keys()}
         \PY{c+c1}{\PYZsh{} outliers\PYZus{}to\PYZus{}drop.values()}
         
         \PY{c+c1}{\PYZsh{} Print out \PYZsh{} of outliers}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{outliers\PYZus{}to\PYZus{}drop}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{col: }\PY{l+s+si}{\PYZob{}k\PYZcb{}}\PY{l+s+s1}{ has }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(v)\PYZcb{} outliers. (}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{round(len(v)/len(df),2)*100\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
col: price has 1131 outliers. (5.0\%)
col: bedrooms has 511 outliers. (2.0\%)
col: sqft\_living has 557 outliers. (3.0\%)
col: bathrooms has 546 outliers. (3.0\%)
col: sqft\_living15 has 532 outliers. (3.0\%)

    \end{Verbatim}

    \hypertarget{filling-in-df_norm}{%
\subsubsection{Filling in df\_norm}\label{filling-in-df_norm}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{c+c1}{\PYZsh{} Intialize df\PYZus{}norm with df\PYZsq{}s values}
         \PY{n}{df\PYZus{}norm}\PY{o}{=}\PY{n}{df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{} Iterate throught outliers\PYZus{}to\PYZus{}drop dictionary to replace outliers with np.nan}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{outliers\PYZus{}to\PYZus{}drop}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{v}\PY{p}{,}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nan} \PY{c+c1}{\PYZsh{} axis=0,inplace=True)}
         
         \PY{c+c1}{\PYZsh{} Display null values}
         \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}67}]:} price                1131
         bedrooms              511
         bathrooms             546
         sqft\_living           557
         sqft\_lot                0
         floors                  0
         condition               0
         grade                   0
         zipcode                 0
         sqft\_living15         532
         sqft\_lot15              0
         code\_view               0
         code\_waterfront         0
         is\_reno                 0
         bins\_yrbuilt            0
         bins\_sqftbasement       0
         bins\_sqftabove          0
         dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{c+c1}{\PYZsh{} REMOVING OUTLIERS FROM PRICE}
         \PY{n}{drop\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for }\PY{l+s+si}{\PYZob{}drop\PYZus{}col\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} of intial rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} after dropping rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Outliers remaining: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{df\PYZus{}norm.isna().sum()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
for price:
\# of intial rows: 21082
\# after dropping rows: 19951

Outliers remaining: 
price                  0
bedrooms             449
bathrooms            253
sqft\_living          169
sqft\_lot               0
floors                 0
condition              0
grade                  0
zipcode                0
sqft\_living15        231
sqft\_lot15             0
code\_view              0
code\_waterfront        0
is\_reno                0
bins\_yrbuilt           0
bins\_sqftbasement      0
bins\_sqftabove         0
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{c+c1}{\PYZsh{} REMOVING OUTLIERS FROM BEDROOMS}
         \PY{n}{drop\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for }\PY{l+s+si}{\PYZob{}drop\PYZus{}col\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} of intial rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{n}{drop\PYZus{}col}\PY{p}{]}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} after dropping rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Outliers remaining: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{df\PYZus{}norm.isna().sum()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
for bedrooms:
\# of intial rows: 19951
\# after dropping rows: 19502

Outliers remaining: 
price                  0
bedrooms               0
bathrooms            196
sqft\_living          150
sqft\_lot               0
floors                 0
condition              0
grade                  0
zipcode                0
sqft\_living15        228
sqft\_lot15             0
code\_view              0
code\_waterfront        0
is\_reno                0
bins\_yrbuilt           0
bins\_sqftbasement      0
bins\_sqftabove         0
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{} REMOVING OUTLIERS FROM PRICE}
         
         \PY{n}{drop\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for }\PY{l+s+si}{\PYZob{}drop\PYZus{}col\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} of intial rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{n}{drop\PYZus{}col}\PY{p}{]}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} after dropping rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Outliers remaining: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{df\PYZus{}norm.isna().sum()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
for sqft\_living:
\# of intial rows: 19502
\# after dropping rows: 19352

Outliers remaining: 
price                  0
bedrooms               0
bathrooms            147
sqft\_living            0
sqft\_lot               0
floors                 0
condition              0
grade                  0
zipcode                0
sqft\_living15        176
sqft\_lot15             0
code\_view              0
code\_waterfront        0
is\_reno                0
bins\_yrbuilt           0
bins\_sqftbasement      0
bins\_sqftabove         0
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{c+c1}{\PYZsh{} REMOVING OUTLIERS FROM BATHROOMS}
         \PY{n}{drop\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for }\PY{l+s+si}{\PYZob{}drop\PYZus{}col\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} of intial rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{n}{drop\PYZus{}col}\PY{p}{]}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} after dropping rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Outliers remaining: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{df\PYZus{}norm.isna().sum()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
for bathrooms:
\# of intial rows: 19352
\# after dropping rows: 19205

Outliers remaining: 
price                  0
bedrooms               0
bathrooms              0
sqft\_living            0
sqft\_lot               0
floors                 0
condition              0
grade                  0
zipcode                0
sqft\_living15        152
sqft\_lot15             0
code\_view              0
code\_waterfront        0
is\_reno                0
bins\_yrbuilt           0
bins\_sqftbasement      0
bins\_sqftabove         0
dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{drop\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for }\PY{l+s+si}{\PYZob{}drop\PYZus{}col\PYZcb{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} of intial rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{n}{drop\PYZus{}col}\PY{p}{]}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} after dropping rows: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}norm)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Outliers remaining: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{df\PYZus{}norm.isna().sum()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
for sqft\_living15:
\# of intial rows: 19205
\# after dropping rows: 19053

Outliers remaining: 
price                0
bedrooms             0
bathrooms            0
sqft\_living          0
sqft\_lot             0
floors               0
condition            0
grade                0
zipcode              0
sqft\_living15        0
sqft\_lot15           0
code\_view            0
code\_waterfront      0
is\_reno              0
bins\_yrbuilt         0
bins\_sqftbasement    0
bins\_sqftabove       0
dtype: int64

    \end{Verbatim}

    \hypertarget{normalizing-units-robustscaler}{%
\subsection{NORMALIZING UNITS
(RobustScaler)}\label{normalizing-units-robustscaler}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{c+c1}{\PYZsh{} ADDING OUTLIER REMOVAL FROM preprocessing.RobuseScaler}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{RobustScaler}
         
         \PY{n}{robscaler} \PY{o}{=} \PY{n}{RobustScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{robscaler}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}73}]:} RobustScaler(copy=True, quantile\_range=(25.0, 75.0), with\_centering=True,
                with\_scaling=True)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{n}{vars\PYZus{}to\PYZus{}scale} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}lot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqft\PYZus{}lot15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{vars\PYZus{}to\PYZus{}scale}\PY{p}{:}
                     
             \PY{n}{col\PYZus{}data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{df\PYZus{}norm}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{res} \PY{o}{=} \PY{n}{robscaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{col\PYZus{}data}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{},df[\PYZsq{}price\PYZsq{}])}
             \PY{n}{df\PYZus{}norm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sca\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{res}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{c+c1}{\PYZsh{} IF DROPPING VARS UNCOMMENT BELOW}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm.drop(vars\PYZus{}to\PYZus{}scale,axis=1,inplace=True)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 23 columns):
price                19053 non-null float64
bedrooms             19053 non-null float64
bathrooms            19053 non-null float64
sqft\_living          19053 non-null float64
sqft\_lot             19053 non-null int64
floors               19053 non-null float64
condition            19053 non-null int64
grade                19053 non-null int64
zipcode              19053 non-null category
sqft\_living15        19053 non-null float64
sqft\_lot15           19053 non-null int64
code\_view            19053 non-null int8
code\_waterfront      19053 non-null int8
is\_reno              19053 non-null int64
bins\_yrbuilt         19053 non-null category
bins\_sqftbasement    19053 non-null category
bins\_sqftabove       19053 non-null category
sca\_sqft\_living      19053 non-null float64
sca\_sqft\_lot         19053 non-null float64
sca\_sqft\_living15    19053 non-null float64
sca\_sqft\_lot15       19053 non-null float64
sca\_bedrooms         19053 non-null float64
sca\_bathrooms        19053 non-null float64
dtypes: category(4), float64(12), int64(5), int8(2)
memory usage: 2.7 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}77}]:}       price  bedrooms  bathrooms  sqft\_living  sqft\_lot  floors  condition  \textbackslash{}
         0  221900.0       3.0       1.00       1180.0      5650     1.0          3   
         1  538000.0       3.0       2.25       2570.0      7242     2.0          3   
         2  180000.0       2.0       1.00        770.0     10000     1.0          3   
         3  604000.0       4.0       3.00       1960.0      5000     1.0          5   
         4  510000.0       3.0       2.00       1680.0      8080     1.0          3   
         
            grade zipcode  sqft\_living15  {\ldots}  is\_reno      bins\_yrbuilt  \textbackslash{}
         0      7   98178         1340.0  {\ldots}        0  (1950.0, 1960.0]   
         1      7   98125         1690.0  {\ldots}        1  (1950.0, 1960.0]   
         2      6   98028         2720.0  {\ldots}        0  (1930.0, 1940.0]   
         3      7   98136         1360.0  {\ldots}        0  (1960.0, 1970.0]   
         4      8   98074         1800.0  {\ldots}        0  (1980.0, 1990.0]   
         
            bins\_sqftbasement    bins\_sqftabove sca\_sqft\_living sca\_sqft\_lot  \textbackslash{}
         0        (-inf, 1.0]  (1000.0, 1500.0]       -0.663265    -0.355075   
         1       (1.0, 501.0]  (2000.0, 2500.0]        0.755102    -0.047858   
         2        (-inf, 1.0]   (500.0, 1000.0]       -1.081633     0.484369   
         3    (501.0, 1001.0]  (1000.0, 1500.0]        0.132653    -0.480509   
         4        (-inf, 1.0]  (1500.0, 2000.0]       -0.153061     0.113856   
         
           sca\_sqft\_living15  sca\_sqft\_lot15  sca\_bedrooms  sca\_bathrooms  
         0         -0.569620       -0.391872           0.0          -1.00  
         1         -0.126582        0.026953           0.0           0.25  
         2          1.177215        0.116024          -1.0          -1.00  
         3         -0.544304       -0.528743           1.0           1.00  
         4          0.012658       -0.001685           0.0           0.00  
         
         [5 rows x 23 columns]
\end{Verbatim}
            
    \hypertarget{normalizing-by-logz-score-old}{%
\paragraph{Normalizing by log+z-score
(OLD)}\label{normalizing-by-logz-score-old}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} Normalize chosen vars}
         \PY{c+c1}{\PYZsh{} \PYZsh{} df\PYZus{}norm = pd.DataFrame(\PYZob{}\PYZcb{})}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm[\PYZsq{}logz\PYZus{}price\PYZsq{}] = log\PYZus{}z(df[\PYZsq{}price\PYZsq{}])}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm[\PYZsq{}logz\PYZus{}sqft\PYZus{}living\PYZsq{}] = log\PYZus{}z(df[\PYZsq{}sqft\PYZus{}living\PYZsq{}])a}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm[\PYZsq{}logz\PYZus{}sqft\PYZus{}living15\PYZsq{}] = log\PYZus{}z(df[\PYZsq{}sqft\PYZus{}living15\PYZsq{}])}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm[\PYZsq{}logz\PYZus{}sqft\PYZus{}lot\PYZsq{}] = log\PYZus{}z(df[\PYZsq{}sqft\PYZus{}lot\PYZsq{}])}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm[\PYZsq{}logz\PYZus{}sqft\PYZus{}lot15\PYZsq{}] = log\PYZus{}z(df[\PYZsq{}sqft\PYZus{}lot15\PYZsq{}])}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm.index = df.index}
\end{Verbatim}


    \hypertarget{normalizing-to-z-score-removing-3-std-old}{%
\paragraph{Normalizing to z-score + removing \textgreater{}3 STD
(OLD)}\label{normalizing-to-z-score-removing-3-std-old}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{c+c1}{\PYZsh{} Z\PYZhy{}SCORE AND REMOVE \PYZgt{}3 STD }
         \PY{c+c1}{\PYZsh{} vars\PYZus{}dont\PYZus{}norm = [\PYZsq{}yr\PYZus{}renovated\PYZsq{},\PYZsq{}yr\PYZus{}built\PYZsq{},\PYZsq{}floors\PYZsq{},\PYZsq{}view\PYZsq{},\PYZsq{}grade\PYZsq{},\PYZsq{}condition\PYZsq{}]}
         \PY{c+c1}{\PYZsh{} vars\PYZus{}to\PYZus{}norm = df.describe().drop(vars\PYZus{}dont\PYZus{}norm,axis=1).columns}
         \PY{c+c1}{\PYZsh{} vars\PYZus{}to\PYZus{}rem\PYZus{}out = None}
         
         \PY{c+c1}{\PYZsh{} col\PYZus{}names =vars\PYZus{}to\PYZus{}rem\PYZus{}out}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm = df[vars\PYZus{}to\PYZus{}norm].copy()}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm[\PYZsq{}id\PYZsq{}] = df[\PYZsq{}id\PYZsq{}].copy()}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm.set\PYZus{}index(\PYZsq{}id\PYZsq{})}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm.info()}
                           
         \PY{c+c1}{\PYZsh{} for col in col\PYZus{}names:}
         \PY{c+c1}{\PYZsh{}       if col != \PYZsq{}id\PYZsq{}:}
         \PY{c+c1}{\PYZsh{}         df\PYZus{}norm[\PYZsq{}zClean\PYZus{}\PYZsq{}+col] = rem\PYZus{}out\PYZus{}z(df[col])}
         \PY{c+c1}{\PYZsh{}     \PYZsh{} df\PYZus{}norm  = df\PYZus{}norm.filter(regex=(\PYZsq{}log\PYZsq{}),axis=1)}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm.info()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{c+c1}{\PYZsh{} Drop na}
         \PY{c+c1}{\PYZsh{} \PYZsh{} df\PYZus{}run = pd.DataFrame(\PYZob{})}
         \PY{c+c1}{\PYZsh{} temp\PYZus{}df = df.filter(regex=(\PYZsq{}bin\PYZsq{}),axis=1)}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run = pd.concat([df\PYZus{}norm,temp\PYZus{}df],axis=1)\PYZsh{},sort=False)}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run.describe()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} LOG TRANSFORM AND Z\PYZhy{}SCORE DATA}
         \PY{c+c1}{\PYZsh{} col\PYZus{}names = vars\PYZus{}to\PYZus{}norm}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm = df[vars\PYZus{}to\PYZus{}norm].copy()}
         \PY{c+c1}{\PYZsh{} \PYZsh{} df\PYZus{}norm.info()}
         \PY{c+c1}{\PYZsh{} for col in col\PYZus{}names:}
         \PY{c+c1}{\PYZsh{}     data\PYZus{}to\PYZus{}log = df.loc[df[col]\PYZgt{}0]}
         \PY{c+c1}{\PYZsh{}     df\PYZus{}norm[\PYZsq{}logZ\PYZus{}\PYZsq{}+col] = log\PYZus{}z(data\PYZus{}to\PYZus{}log[col])}
         \PY{c+c1}{\PYZsh{} \PYZsh{}     df\PYZus{}norm[\PYZsq{}logZ\PYZus{}\PYZsq{}+col] = log\PYZus{}z(df[col])}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm  = df\PYZus{}norm.filter(regex=(\PYZsq{}log\PYZsq{}),axis=1)}
         \PY{c+c1}{\PYZsh{} df\PYZus{}norm.info()}
\end{Verbatim}


    \hypertarget{checking-normalized-dataset}{%
\section{CHECKING NORMALIZED
DATASET}\label{checking-normalized-dataset}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fivethirtyeight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plot\PYZus{}hist\PYZus{}scat}\PY{p}{(}\PY{n}{df\PYZus{}norm}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}82}]:}         0         1      2
         0  column  K\_square  p-val
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_5.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_11.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_15.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_17.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_18.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_133_19.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 23 columns):
price                19053 non-null float64
bedrooms             19053 non-null float64
bathrooms            19053 non-null float64
sqft\_living          19053 non-null float64
sqft\_lot             19053 non-null int64
floors               19053 non-null float64
condition            19053 non-null int64
grade                19053 non-null int64
zipcode              19053 non-null category
sqft\_living15        19053 non-null float64
sqft\_lot15           19053 non-null int64
code\_view            19053 non-null int8
code\_waterfront      19053 non-null int8
is\_reno              19053 non-null int64
bins\_yrbuilt         19053 non-null category
bins\_sqftbasement    19053 non-null category
bins\_sqftabove       19053 non-null category
sca\_sqft\_living      19053 non-null float64
sca\_sqft\_lot         19053 non-null float64
sca\_sqft\_living15    19053 non-null float64
sca\_sqft\_lot15       19053 non-null float64
sca\_bedrooms         19053 non-null float64
sca\_bathrooms        19053 non-null float64
dtypes: category(4), float64(12), int64(5), int8(2)
memory usage: 2.7 MB

    \end{Verbatim}

    \hypertarget{recheck-multipol}{%
\subsection{Recheck multipol}\label{recheck-multipol}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{multiplot}\PY{p}{(}\PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{filter}\PY{p}{(}\PY{n}{regex}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sca}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaled Data only}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}84}]:} Text(0.5, 1.0, 'Scaled Data only')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_136_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{X} \PY{o}{=}\PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{o}{\PYZti{}}\PY{p}{(}\PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sca}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{]}
         \PY{n}{multiplot}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Un\PYZhy{}scaled Data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{X}\PY{o}{=}\PY{p}{[}\PY{p}{]}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_137_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{no-multicollinearity-to-worry-about.-huzzah}{%
\paragraph{No multicollinearity to worry about.
Huzzah!}\label{no-multicollinearity-to-worry-about.-huzzah}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{c+c1}{\PYZsh{} DEFINING DATASET TO RUN (df\PYZus{}run)}
         \PY{n}{df\PYZus{}run} \PY{o}{=} \PY{n}{df\PYZus{}norm}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run.to\PYZus{}csv(\PYZsq{}df\PYZus{}run\PYZus{}pre\PYZus{}codes.csv\PYZsq{})}
         \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 23 columns):
price                19053 non-null float64
bedrooms             19053 non-null float64
bathrooms            19053 non-null float64
sqft\_living          19053 non-null float64
sqft\_lot             19053 non-null int64
floors               19053 non-null float64
condition            19053 non-null int64
grade                19053 non-null int64
zipcode              19053 non-null category
sqft\_living15        19053 non-null float64
sqft\_lot15           19053 non-null int64
code\_view            19053 non-null int8
code\_waterfront      19053 non-null int8
is\_reno              19053 non-null int64
bins\_yrbuilt         19053 non-null category
bins\_sqftbasement    19053 non-null category
bins\_sqftabove       19053 non-null category
sca\_sqft\_living      19053 non-null float64
sca\_sqft\_lot         19053 non-null float64
sca\_sqft\_living15    19053 non-null float64
sca\_sqft\_lot15       19053 non-null float64
sca\_bedrooms         19053 non-null float64
sca\_bathrooms        19053 non-null float64
dtypes: category(4), float64(12), int64(5), int8(2)
memory usage: 2.7 MB

    \end{Verbatim}

    \hypertarget{cat.codes-for-binned-data}{%
\subsection{CAT.CODES FOR BINNED DATA}\label{cat.codes-for-binned-data}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{df\PYZus{}filt} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}\PY{p}{)}
         
         \PY{n}{df\PYZus{}filt} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{filter}\PY{p}{(}\PY{n}{regex}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}\PY{n}{axis} \PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df\PYZus{}filt}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{df\PYZus{}filt}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 4 columns):
bins\_yrbuilt         19053 non-null category
bins\_sqftbasement    19053 non-null category
bins\_sqftabove       19053 non-null category
zipcode              19053 non-null category
dtypes: category(4)
memory usage: 227.0 KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{c+c1}{\PYZsh{} Creating binned vars cat codes}
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{df\PYZus{}filt}\PY{p}{:}
             \PY{n}{df\PYZus{}filt}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}filt}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{codes}
             \PY{n}{df\PYZus{}filt}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{col}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{df\PYZus{}filt}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 4 columns):
codebins\_yrbuilt         19053 non-null int8
codebins\_sqftbasement    19053 non-null int8
codebins\_sqftabove       19053 non-null int8
codezipcode              19053 non-null int8
dtypes: int8(4)
memory usage: 223.3 KB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{df\PYZus{}filt}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}89}]:}    codebins\_yrbuilt  codebins\_sqftbasement  codebins\_sqftabove  codezipcode
         0                 5                      0                   2           66
         1                 5                      1                   4           55
         2                 3                      0                   1           16
         3                 6                      2                   2           58
         4                 8                      0                   3           37
\end{Verbatim}
            
    \hypertarget{concatenate-final-df-for-modeling-df_run}{%
\subsection{Concatenate final df for modeling
(df\_run)}\label{concatenate-final-df-for-modeling-df_run}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Select columns that do not contain the string \PYZsq{}logZ\PYZsq{}}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run =df\PYZus{}run.loc[:,\PYZti{}(df\PYZus{}run.columns.str.startswith(\PYZsq{}logZ\PYZsq{}))]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} df\PYZus{}filt[\PYZsq{}price\PYZsq{}] = df\PYZus{}run[\PYZsq{}price\PYZsq{}].copy()}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run =df\PYZus{}run.loc[:,\PYZti{}(df\PYZus{}run.columns.str.startswith(\PYZsq{}bin\PYZsq{}))]}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run.info()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{c+c1}{\PYZsh{} \PYZsh{} DECIDE NOW IF WANT CLEAN OR NOT CLEANED DATA}
         
         \PY{c+c1}{\PYZsh{} to\PYZus{}drop\PYZus{}unclean = [\PYZsq{}bedrooms\PYZsq{},\PYZsq{}bathrooms\PYZsq{},\PYZsq{}sqft\PYZus{}living\PYZsq{},\PYZsq{}sqft\PYZus{}lot\PYZsq{},\PYZsq{}sqft\PYZus{}living15\PYZsq{},\PYZsq{}sqft\PYZus{}lot15\PYZsq{},\PYZsq{}zClean\PYZus{}price\PYZsq{}]}
         \PY{c+c1}{\PYZsh{} to\PYZus{}drop\PYZus{}clean = list(df\PYZus{}run.loc[:,\PYZti{}(df\PYZus{}run.columns.str.startswith(\PYZsq{}zClean\PYZsq{}))].columns)}
         \PY{c+c1}{\PYZsh{} to\PYZus{}drop\PYZus{}unclean, to\PYZus{}drop\PYZus{}clean}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{c+c1}{\PYZsh{} DROP UNCLEAN}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run.drop([\PYZsq{}id\PYZsq{},\PYZsq{}bedrooms\PYZsq{},\PYZsq{}bathrooms\PYZsq{},\PYZsq{}sqft\PYZus{}living\PYZsq{},\PYZsq{}sqft\PYZus{}lot\PYZsq{},\PYZsq{}sqft\PYZus{}living15\PYZsq{},\PYZsq{}sqft\PYZus{}lot15\PYZsq{},\PYZsq{}zClean\PYZus{}price\PYZsq{}],axis=1,inplace=True)}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run.drop(to\PYZus{}drop\PYZus{}unclean,axis=1,inplace=True)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{c+c1}{\PYZsh{} Concatenate codebins from df\PYZus{}filt + df\PYZus{}run}
         \PY{n}{df\PYZus{}run} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{df\PYZus{}run}\PY{p}{,} \PY{n}{df\PYZus{}filt}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}  \PY{c+c1}{\PYZsh{}).filter(regex=(\PYZsq{}code\PYZsq{}))],axis=1)}
         \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 27 columns):
price                    19053 non-null float64
bedrooms                 19053 non-null float64
bathrooms                19053 non-null float64
sqft\_living              19053 non-null float64
sqft\_lot                 19053 non-null int64
floors                   19053 non-null float64
condition                19053 non-null int64
grade                    19053 non-null int64
zipcode                  19053 non-null category
sqft\_living15            19053 non-null float64
sqft\_lot15               19053 non-null int64
code\_view                19053 non-null int8
code\_waterfront          19053 non-null int8
is\_reno                  19053 non-null int64
bins\_yrbuilt             19053 non-null category
bins\_sqftbasement        19053 non-null category
bins\_sqftabove           19053 non-null category
sca\_sqft\_living          19053 non-null float64
sca\_sqft\_lot             19053 non-null float64
sca\_sqft\_living15        19053 non-null float64
sca\_sqft\_lot15           19053 non-null float64
sca\_bedrooms             19053 non-null float64
sca\_bathrooms            19053 non-null float64
codebins\_yrbuilt         19053 non-null int8
codebins\_sqftbasement    19053 non-null int8
codebins\_sqftabove       19053 non-null int8
codezipcode              19053 non-null int8
dtypes: category(4), float64(12), int64(5), int8(6)
memory usage: 2.8 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}95}]:}       price  bedrooms  bathrooms  sqft\_living  sqft\_lot  floors  condition  \textbackslash{}
         0  221900.0       3.0       1.00       1180.0      5650     1.0          3   
         1  538000.0       3.0       2.25       2570.0      7242     2.0          3   
         
            grade zipcode  sqft\_living15  {\ldots}  sca\_sqft\_living  sca\_sqft\_lot  \textbackslash{}
         0      7   98178         1340.0  {\ldots}        -0.663265     -0.355075   
         1      7   98125         1690.0  {\ldots}         0.755102     -0.047858   
         
            sca\_sqft\_living15  sca\_sqft\_lot15 sca\_bedrooms sca\_bathrooms  \textbackslash{}
         0          -0.569620       -0.391872          0.0         -1.00   
         1          -0.126582        0.026953          0.0          0.25   
         
           codebins\_yrbuilt  codebins\_sqftbasement  codebins\_sqftabove  codezipcode  
         0                5                      0                   2           66  
         1                5                      1                   4           55  
         
         [2 rows x 27 columns]
\end{Verbatim}
            
    \hypertarget{clever-line-of-code-to-select-columns-by-name}{%
\paragraph{Clever line of code to select columns by
name}\label{clever-line-of-code-to-select-columns-by-name}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Select columns that do not contain the string 'logZ'}
\NormalTok{df_run }\OperatorTok{=}\NormalTok{df_run.loc[:,}\OperatorTok{~}\NormalTok{(df_run.columns.}\BuiltInTok{str}\NormalTok{.startswith(}\StringTok{'logZ'}\NormalTok{))]}
\end{Highlighting}
\end{Shaded}

    \hypertarget{savingloading-df_run-after-cleaning-up}{%
\subsubsection{Saving/loading df\_run after cleaning
up}\label{savingloading-df_run-after-cleaning-up}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{c+c1}{\PYZsh{} bookmark 202am}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run.to\PYZus{}csv(\PYZsq{}df\PYZus{}run\PYZus{}coded.csv\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}97}]:} \PY{c+c1}{\PYZsh{} df\PYZus{}run = pd.read\PYZus{}csv(\PYZsq{}df\PYZus{}run\PYZus{}coded.csv\PYZsq{})}
         \PY{c+c1}{\PYZsh{} df\PYZus{}run.info()}
\end{Verbatim}


    \hypertarget{fitting-an-intial-model}{%
\section{FITTING AN INTIAL MODEL:}\label{fitting-an-intial-model}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 27 columns):
price                    19053 non-null float64
bedrooms                 19053 non-null float64
bathrooms                19053 non-null float64
sqft\_living              19053 non-null float64
sqft\_lot                 19053 non-null int64
floors                   19053 non-null float64
condition                19053 non-null int64
grade                    19053 non-null int64
zipcode                  19053 non-null category
sqft\_living15            19053 non-null float64
sqft\_lot15               19053 non-null int64
code\_view                19053 non-null int8
code\_waterfront          19053 non-null int8
is\_reno                  19053 non-null int64
bins\_yrbuilt             19053 non-null category
bins\_sqftbasement        19053 non-null category
bins\_sqftabove           19053 non-null category
sca\_sqft\_living          19053 non-null float64
sca\_sqft\_lot             19053 non-null float64
sca\_sqft\_living15        19053 non-null float64
sca\_sqft\_lot15           19053 non-null float64
sca\_bedrooms             19053 non-null float64
sca\_bathrooms            19053 non-null float64
codebins\_yrbuilt         19053 non-null int8
codebins\_sqftbasement    19053 non-null int8
codebins\_sqftabove       19053 non-null int8
codezipcode              19053 non-null int8
dtypes: category(4), float64(12), int64(5), int8(6)
memory usage: 2.8 MB

    \end{Verbatim}

    \hypertarget{determining-ideal-features-to-use}{%
\subsection{DETERMINING IDEAL FEATURES TO
USE}\label{determining-ideal-features-to-use}}

\begin{itemize}
\tightlist
\item
  Use MinMaxScaler to get on same scale
\item
  Use RFE to find the best features
\item
  Get ranking of feature importance (from both scaled and unscaled data)
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{RFE}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{MinMaxScaler}
         
         \PY{k+kn}{import} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{as} \PY{n+nn}{metrics}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}100}]:} \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 27 columns):
price                    19053 non-null float64
bedrooms                 19053 non-null float64
bathrooms                19053 non-null float64
sqft\_living              19053 non-null float64
sqft\_lot                 19053 non-null int64
floors                   19053 non-null float64
condition                19053 non-null int64
grade                    19053 non-null int64
zipcode                  19053 non-null category
sqft\_living15            19053 non-null float64
sqft\_lot15               19053 non-null int64
code\_view                19053 non-null int8
code\_waterfront          19053 non-null int8
is\_reno                  19053 non-null int64
bins\_yrbuilt             19053 non-null category
bins\_sqftbasement        19053 non-null category
bins\_sqftabove           19053 non-null category
sca\_sqft\_living          19053 non-null float64
sca\_sqft\_lot             19053 non-null float64
sca\_sqft\_living15        19053 non-null float64
sca\_sqft\_lot15           19053 non-null float64
sca\_bedrooms             19053 non-null float64
sca\_bathrooms            19053 non-null float64
codebins\_yrbuilt         19053 non-null int8
codebins\_sqftbasement    19053 non-null int8
codebins\_sqftabove       19053 non-null int8
codezipcode              19053 non-null int8
dtypes: category(4), float64(12), int64(5), int8(6)
memory usage: 2.8 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{c+c1}{\PYZsh{} Define selector function combining RFE and linear regression}
          \PY{n}{linreg} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
          \PY{n}{selector} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{linreg}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Drop already scaled variables for this feature testing}
          \PY{n}{X} \PY{o}{=}\PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{o}{\PYZti{}}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bins}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{]}
          \PY{n}{X} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} RUNNING RFE ON THE UNSCALED DATA(DEMONSTRATION)}
          \PY{n}{Y} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{c+c1}{\PYZsh{} Y = df\PYZus{}run[\PYZsq{}logz\PYZus{}price\PYZsq{}]}
          \PY{c+c1}{\PYZsh{} X = df\PYZus{}run.drop([\PYZsq{}price\PYZsq{}],axis=1)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{c+c1}{\PYZsh{} Checking X}
          \PY{n}{X}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 22 columns):
bedrooms                 19053 non-null float64
bathrooms                19053 non-null float64
sqft\_living              19053 non-null float64
sqft\_lot                 19053 non-null int64
floors                   19053 non-null float64
condition                19053 non-null int64
grade                    19053 non-null int64
sqft\_living15            19053 non-null float64
sqft\_lot15               19053 non-null int64
code\_view                19053 non-null int8
code\_waterfront          19053 non-null int8
is\_reno                  19053 non-null int64
sca\_sqft\_living          19053 non-null float64
sca\_sqft\_lot             19053 non-null float64
sca\_sqft\_living15        19053 non-null float64
sca\_sqft\_lot15           19053 non-null float64
sca\_bedrooms             19053 non-null float64
sca\_bathrooms            19053 non-null float64
codebins\_yrbuilt         19053 non-null int8
codebins\_sqftbasement    19053 non-null int8
codebins\_sqftabove       19053 non-null int8
codezipcode              19053 non-null int8
dtypes: float64(11), int64(5), int8(6)
memory usage: 2.6 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{c+c1}{\PYZsh{} Run regressions on X,Y }
          \PY{n}{selector} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Saving unscaled rankings for demo purposes}
          \PY{n}{no\PYZus{}scale} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{ranking\PYZus{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}104}]:} \PY{c+c1}{\PYZsh{} Scale all variables to value between 0\PYZhy{}1 to use RFE to determine which features are the most important for determining price?}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{MinMaxScaler}
          \PY{n}{scaler} \PY{o}{=} \PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Scale the data before running RFE}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Consider revisiting this step and dummy\PYZhy{}coding zipcode.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} ONLY SCALE NON\PYZhy{}CATEGORICAL, ONE\PYZhy{}HOT CATEGORICAL}
          \PY{n}{scaler}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{)}
          \PY{n}{scaled\PYZus{}data} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
          \PY{n}{scaled\PYZus{}data}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Consider revisiting this step and dummy-coding zipcode.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}sklearn\textbackslash{}preprocessing\textbackslash{}data.py:323: DataConversionWarning: Data with input dtype int8, int64, float64 were all converted to float64 by MinMaxScaler.
  return self.partial\_fit(X, y)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}104}]:} (19053, 22)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}105}]:} \PY{c+c1}{\PYZsh{} Running RFE with scaled data}
          \PY{n}{selector} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{scaled\PYZus{}data}\PY{p}{,} \PY{n}{Y}\PY{p}{)} 
          \PY{n}{scaled} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{ranking\PYZus{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{c+c1}{\PYZsh{} Create a dataframe with the ranked values of each feature for both scaled and unscaled data}
          \PY{n}{best\PYZus{}features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scaled\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{n}{scaled}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unscaled\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{no\PYZus{}scale}\PY{p}{\PYZcb{}}\PY{p}{)}
          \PY{n}{best\PYZus{}features}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{c+c1}{\PYZsh{} Display dataframe (sorted based on unscaled rank)}
          \PY{n}{best\PYZus{}features}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unscaled\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}107}]:}                        scaled\_rank  unscaled\_rank
          columns                                          
          grade                            1              1
          code\_view                        8              2
          codebins\_sqftbasement           11              3
          codebins\_sqftabove              21              4
          floors                           9              5
          codebins\_yrbuilt                 3              6
          sca\_bathrooms                   18              7
          is\_reno                         20              8
          condition                       13              9
          sca\_bedrooms                    19             10
          bathrooms                       15             11
          bedrooms                        16             12
          code\_waterfront                 22             13
          codezipcode                     17             14
          sqft\_living                      2             15
          sqft\_living15                   12             16
          sqft\_lot15                      14             17
          sqft\_lot                         5             18
          sca\_sqft\_living15                7             19
          sca\_sqft\_living                  4             20
          sca\_sqft\_lot15                   6             21
          sca\_sqft\_lot                    10             22
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{c+c1}{\PYZsh{} Plot the difference in feature importance between analyzing scaled and unscaled data. }
          \PY{c+c1}{\PYZsh{} For demonstration purposes.}
          \PY{n}{features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Not\PYZus{}Scaled}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{no\PYZus{}scale}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scaled}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{scaled}\PY{p}{\PYZcb{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} PLot the difference between }
          \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seaborn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} plt.xkcd()}
          \PY{n}{ax} \PY{o}{=} \PY{n}{features}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Feature Importance Scaled vs. Not Scaled}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features Importance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}108}]:} Text(0, 0.5, 'Features Importance')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_167_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{using-elbow-plots-to-identify-the-best-of-features-to-use}{%
\subsubsection{Using elbow plots to identify the best \# of features to
use}\label{using-elbow-plots-to-identify-the-best-of-features-to-use}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{X}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 22 columns):
bedrooms                 19053 non-null float64
bathrooms                19053 non-null float64
sqft\_living              19053 non-null float64
sqft\_lot                 19053 non-null int64
floors                   19053 non-null float64
condition                19053 non-null int64
grade                    19053 non-null int64
sqft\_living15            19053 non-null float64
sqft\_lot15               19053 non-null int64
code\_view                19053 non-null int8
code\_waterfront          19053 non-null int8
is\_reno                  19053 non-null int64
sca\_sqft\_living          19053 non-null float64
sca\_sqft\_lot             19053 non-null float64
sca\_sqft\_living15        19053 non-null float64
sca\_sqft\_lot15           19053 non-null float64
sca\_bedrooms             19053 non-null float64
sca\_bathrooms            19053 non-null float64
codebins\_yrbuilt         19053 non-null int8
codebins\_sqftbasement    19053 non-null int8
codebins\_sqftabove       19053 non-null int8
codezipcode              19053 non-null int8
dtypes: float64(11), int64(5), int8(6)
memory usage: 2.6 MB

    \end{Verbatim}

    \hypertarget{plot-r_squared-and-mse-for-scaled-data}{%
\paragraph{Plot R\_squared and MSE for Scaled
Data}\label{plot-r_squared-and-mse-for-scaled-data}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{n}{r\PYZus{}squared} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{selector} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{linreg}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{n}{x}\PY{p}{)}
              \PY{n}{selector}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{scaled\PYZus{}data}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{linreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{r\PYZus{}sq} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{r\PYZus{}squared}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{r\PYZus{}sq}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{c+c1}{\PYZsh{} r\PYZus{}squared}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}
          
          \PY{n}{mse}\PY{o}{=}\PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{selector} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{linreg}\PY{p}{,}  \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{n}{x}\PY{p}{)}
              \PY{n}{selector}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{scaled\PYZus{}data}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{linreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{mse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} mse}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12} \PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{ax1} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{r\PYZus{}squared}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}Squared}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{ax2} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
          \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{mse}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{mse} \PY{p}{)}
          \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
          \PY{n}{ax2}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_174_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{plot-r_squared-and-mse-for-unscaled-data}{%
\paragraph{Plot R\_squared and MSE for Unscaled
Data}\label{plot-r_squared-and-mse-for-unscaled-data}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{n}{r\PYZus{}squared} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{selector} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{linreg}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{n}{x}\PY{p}{)}
              \PY{n}{selector}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{linreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{r\PYZus{}sq} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{r\PYZus{}squared}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{r\PYZus{}sq}\PY{p}{)}
          
              
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}
          
          \PY{n}{mse}\PY{o}{=}\PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{selector} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{linreg}\PY{p}{,}  \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{n}{x}\PY{p}{)}
              \PY{n}{selector}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{linreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{Y}\PY{p}{)}
              \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{selector}\PY{o}{.}\PY{n}{support\PYZus{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
              \PY{n}{mse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{Y}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
          
          
          
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12} \PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{ax1} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{r\PYZus{}squared}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}Squared}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax1}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{ax2} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
          \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{mse}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{mse} \PY{p}{)}
          \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ax2}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)} 
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_176_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{choosing-features-based-on-rankings}{%
\subsubsection{Choosing Features Based on
Rankings}\label{choosing-features-based-on-rankings}}

\begin{itemize}
\tightlist
\item
  The above figure is indicating that right now my best possible R2 with
  the lowest \# of features would be with 6 predictors (judging unscaled
  data).
\item
  Now examine the sorted best\_features dataframe to see which 6 to use
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{best\PYZus{}features}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unscaled\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}115}]:}                        scaled\_rank  unscaled\_rank
          columns                                          
          grade                            1              1
          code\_view                        8              2
          codebins\_sqftbasement           11              3
          codebins\_sqftabove              21              4
          floors                           9              5
          codebins\_yrbuilt                 3              6
          sca\_bathrooms                   18              7
          is\_reno                         20              8
          condition                       13              9
          sca\_bedrooms                    19             10
          bathrooms                       15             11
          bedrooms                        16             12
          code\_waterfront                 22             13
          codezipcode                     17             14
          sqft\_living                      2             15
          sqft\_living15                   12             16
          sqft\_lot15                      14             17
          sqft\_lot                         5             18
          sca\_sqft\_living15                7             19
          sca\_sqft\_living                  4             20
          sca\_sqft\_lot15                   6             21
          sca\_sqft\_lot                    10             22
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{c+c1}{\PYZsh{} Pull out the 6 best features via ranking }
          \PY{n}{best\PYZus{}num\PYZus{}feat} \PY{o}{=} \PY{l+m+mi}{6}
          \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{n}{best\PYZus{}features}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unscaled\PYZus{}rank}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{best\PYZus{}num\PYZus{}feat}\PY{p}{]}
          \PY{n}{selected\PYZus{}features}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}116}]:}                        scaled\_rank  unscaled\_rank
          columns                                          
          grade                            1              1
          code\_view                        8              2
          codebins\_sqftbasement           11              3
          codebins\_sqftabove              21              4
          floors                           9              5
          codebins\_yrbuilt                 3              6
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}117}]:} \PY{c+c1}{\PYZsh{} USING UNSCALED}
          \PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{index}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}117}]:} Index(['grade', 'code\_view', 'codebins\_sqftbasement', 'codebins\_sqftabove',
                 'floors', 'codebins\_yrbuilt'],
                dtype='object', name='columns')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{c+c1}{\PYZsh{} Check the columns of X}
          \PY{n}{X}\PY{p}{[}\PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}118}]:}    grade  code\_view  codebins\_sqftbasement  codebins\_sqftabove  floors  \textbackslash{}
          0      7          0                      0                   2     1.0   
          1      7          0                      1                   4     2.0   
          2      6          0                      0                   1     1.0   
          3      7          0                      2                   2     1.0   
          4      8          0                      0                   3     1.0   
          
             codebins\_yrbuilt  
          0                 5  
          1                 5  
          2                 3  
          3                 6  
          4                 8  
\end{Verbatim}
            
    \hypertarget{preliminary-univariate-linear-regression-modeling}{%
\subsection{PRELIMINARY UNIVARIATE LINEAR REGRESSION
MODELING}\label{preliminary-univariate-linear-regression-modeling}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 27 columns):
price                    19053 non-null float64
bedrooms                 19053 non-null float64
bathrooms                19053 non-null float64
sqft\_living              19053 non-null float64
sqft\_lot                 19053 non-null int64
floors                   19053 non-null float64
condition                19053 non-null int64
grade                    19053 non-null int64
zipcode                  19053 non-null category
sqft\_living15            19053 non-null float64
sqft\_lot15               19053 non-null int64
code\_view                19053 non-null int8
code\_waterfront          19053 non-null int8
is\_reno                  19053 non-null int64
bins\_yrbuilt             19053 non-null category
bins\_sqftbasement        19053 non-null category
bins\_sqftabove           19053 non-null category
sca\_sqft\_living          19053 non-null float64
sca\_sqft\_lot             19053 non-null float64
sca\_sqft\_living15        19053 non-null float64
sca\_sqft\_lot15           19053 non-null float64
sca\_bedrooms             19053 non-null float64
sca\_bathrooms            19053 non-null float64
codebins\_yrbuilt         19053 non-null int8
codebins\_sqftbasement    19053 non-null int8
codebins\_sqftabove       19053 non-null int8
codezipcode              19053 non-null int8
dtypes: category(4), float64(12), int64(5), int8(6)
memory usage: 2.8 MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{c+c1}{\PYZsh{} Running simple linear regression for each predictor on its own}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{smf}
          \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{stats}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sms}
          
          
          \PY{c+c1}{\PYZsh{} log\PYZus{}price = np.log(df[\PYZsq{}price\PYZsq{}])}
          \PY{c+c1}{\PYZsh{} df[\PYZsq{}log\PYZus{}price\PYZsq{}] = log\PYZus{}price}
          
          \PY{n}{target\PYZus{}var} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}
          \PY{n}{col\PYZus{}names} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{columns}
          
          \PY{c+c1}{\PYZsh{} Create results list for saving the output statstics for each predictor}
          \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ind\PYZus{}var}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZus{}squared}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{intercept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{slope}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{p\PYZhy{}value}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]}\PY{p}{]} 
          
          \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{val} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{col\PYZus{}names}\PY{p}{)}\PY{p}{:} 
              
              \PY{c+c1}{\PYZsh{} Use the names of the columns to determine format of forumla  }
              \PY{k}{if} \PY{n}{val}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                  
                  \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{val}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{val}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{as\PYZus{}ordered}\PY{p}{(}\PY{p}{)} 
                  \PY{n}{f} \PY{o}{=}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{str(target\PYZus{}var)\PYZcb{}\PYZti{}C(}\PY{l+s+si}{\PYZob{}val\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}
                  
              \PY{k}{elif} \PY{n}{val}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                  
                  \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{val}\PY{p}{]} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{val}\PY{p}{]}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{as\PYZus{}ordered}\PY{p}{(}\PY{p}{)} 
                  \PY{n}{f} \PY{o}{=}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{str(target\PYZus{}var)\PYZcb{}\PYZti{}C(}\PY{l+s+si}{\PYZob{}val\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}
                  
              \PY{k}{else}\PY{p}{:}
                  
                  \PY{n}{f} \PY{o}{=}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{str(target\PYZus{}var)\PYZcb{}\PYZti{}}\PY{l+s+si}{\PYZob{}val\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}
                  
              \PY{c+c1}{\PYZsh{} Run the ols models     }
              \PY{n}{model} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{n}{formula}\PY{o}{=}\PY{n}{f}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{df\PYZus{}run}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)} 
              \PY{n}{model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
              
              \PY{c+c1}{\PYZsh{} Append results}
              \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{val}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{rsquared}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{params}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{model}\PY{o}{.}\PY{n}{pvalues}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{p}{]}\PY{p}{)} 
              
          \PY{c+c1}{\PYZsh{} Turn results into dataframe with correct index and columns}
          \PY{n}{res\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
          \PY{n}{res\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{n}{res\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{res\PYZus{}df}\PY{o}{=}\PY{n}{res\PYZus{}df}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
          \PY{n}{res\PYZus{}df}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ind\PYZus{}var}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{res\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZus{}squared}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}regression\textbackslash{}linear\_model.py:1633: RuntimeWarning: divide by zero encountered in double\_scalars
  return np.sqrt(eigvals[0]/eigvals[-1])
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}statsmodels\textbackslash{}base\textbackslash{}model.py:1100: RuntimeWarning: invalid value encountered in true\_divide
  return self.params / self.bse
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}scipy\textbackslash{}stats\textbackslash{}\_distn\_infrastructure.py:877: RuntimeWarning: invalid value encountered in greater
  return (self.a < x) \& (x < self.b)
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}scipy\textbackslash{}stats\textbackslash{}\_distn\_infrastructure.py:877: RuntimeWarning: invalid value encountered in less
  return (self.a < x) \& (x < self.b)
C:\textbackslash{}Users\textbackslash{}james\textbackslash{}Anaconda3\textbackslash{}envs\textbackslash{}learn-env\_MD\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}scipy\textbackslash{}stats\textbackslash{}\_distn\_infrastructure.py:1831: RuntimeWarning: invalid value encountered in less\_equal
  cond2 = cond0 \& (x <= self.a)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}120}]:} 0                       r\_squared intercept     slope       p-value
          ind\_var                                                            
          codezipcode              0.498102    280365  -47520.3     0.0002275
          zipcode                  0.498102    280365  -47520.3     0.0002275
          grade                    0.362959   -454845    123114             0
          sqft\_living              0.347657    142997   168.572             0
          sca\_sqft\_living          0.347657    451484    165200             0
          sqft\_living15             0.27516    118553   184.751             0
          sca\_sqft\_living15         0.27516    449258    145953             0
          codebins\_sqftabove       0.225333    210050    141861      0.107357
          bins\_sqftabove           0.225333    210050    141861      0.107357
          bathrooms                0.169802    215907    125027             0
          sca\_bathrooms            0.169802    465961    125027             0
          sca\_bedrooms            0.0717169    447998   68611.9             0
          bedrooms                0.0717169    242163   68611.9             0
          floors                  0.0629911    330868   93475.5  1.61001e-271
          code\_view               0.0563913    455177    168640   1.60061e-43
          bins\_sqftbasement       0.0492165    442306   19843.1   3.81601e-06
          codebins\_sqftbasement   0.0492165    442306   19843.1   3.81601e-06
          codebins\_yrbuilt        0.0482952    543106  -35754.2   0.000899441
          bins\_yrbuilt            0.0482952    543106  -35754.2   0.000899441
          is\_reno                0.00765121    465065    103741   1.10517e-33
          sca\_sqft\_lot           0.00581721    465533   2035.97   5.50156e-26
          sqft\_lot               0.00581721    462590  0.392892   5.50156e-26
          sqft\_lot15             0.00411256    461884  0.518291   7.96816e-19
          sca\_sqft\_lot15         0.00411256    465777   2461.37   7.96816e-19
          code\_waterfront        0.00239512    467280    203173   1.64907e-11
          condition              0.00235454    416978   14985.1     2.065e-11
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{c+c1}{\PYZsh{} Initial variables for modeling}
          \PY{n}{try\PYZus{}modeling} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{codezipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grade}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sca\PYZus{}sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sca\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{c+c1}{\PYZsh{} Hmm...realized there are redundant versions of variables and am just selecting the correct versions to use.}
\end{Verbatim}


    \hypertarget{notes-following-preliminary-linear-regressions}{%
\paragraph{NOTES FOLLOWING PRELIMINARY LINEAR
REGRESSIONS}\label{notes-following-preliminary-linear-regressions}}

\begin{itemize}
\tightlist
\item
  Variables that had high R\_square with logz\_price:

  \begin{itemize}
  \tightlist
  \item
    New results = {[}`codezipcode', `grade',`sca\_sqft\_living',
    `sca\_sqft\_living15'{]}
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ try_modeling }\OperatorTok{=}\NormalTok{ try_modeling }\OperatorTok{=}\NormalTok{ [}\StringTok{'codezipcode'}\NormalTok{, }\StringTok{'grade'}\NormalTok{,}\StringTok{'sca_sqft_living'}\NormalTok{, }\StringTok{'sca_sqft_living16'}\NormalTok{]}

    
\end{Highlighting}
\end{Shaded}

    \hypertarget{multivariate-regressions}{%
\subsection{MULTIVARIATE REGRESSIONS}\label{multivariate-regressions}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{smf}
          \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{stats}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sms}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{MinMaxScaler}
          
          \PY{c+c1}{\PYZsh{} \PYZsh{} PUTTING TOGETHER THE PREDICTORS TO RUN IN THE REGRESSION}
          \PY{c+c1}{\PYZsh{} \PYZsh{}\PYZsh{} Last min dummy vars []\PYZsq{}cat\PYZus{}grade\PYZsq{},\PYZsq{}cat\PYZus{}zipcode\PYZsq{},\PYZsq{}cat\PYZus{}view\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}above\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}basement\PYZsq{}]}
          \PY{c+c1}{\PYZsh{} dum\PYZus{}grades = pd.get\PYZus{}dummies(df\PYZus{}run[\PYZsq{}cat\PYZus{}grade\PYZsq{}],prefix=\PYZsq{}gr\PYZsq{}).iloc[:,:\PYZhy{}1]}
          \PY{c+c1}{\PYZsh{} dum\PYZus{}view = pd.get\PYZus{}dummies(df\PYZus{}run[\PYZsq{}cat\PYZus{}view\PYZsq{}], prefix=\PYZsq{}view\PYZsq{}).iloc[:,:\PYZhy{}1]}
          \PY{c+c1}{\PYZsh{} dum\PYZus{}sqft\PYZus{}above = pd.get\PYZus{}dummies(df\PYZus{}run[\PYZsq{}cat\PYZus{}bins\PYZus{}sqftabove\PYZsq{}],prefix=\PYZsq{}sqftAb\PYZsq{}).iloc[:,:\PYZhy{}1]}
          \PY{c+c1}{\PYZsh{} dum\PYZus{}sqft\PYZus{}base = pd.get\PYZus{}dummies(df\PYZus{}run[\PYZsq{}cat\PYZus{}bins\PYZus{}sqftbasement\PYZsq{}],prefix=\PYZsq{}sqftBa\PYZsq{}).iloc[:,:\PYZhy{}1]}
          
          
          \PY{c+c1}{\PYZsh{} RUNNING K\PYZhy{}FOLD VALIDATION WITH STATSMODELS OLS.}
          \PY{c+c1}{\PYZsh{} X = df\PYZus{}run.drop([\PYZsq{}price\PYZsq{},\PYZsq{}logZ\PYZus{}price\PYZsq{}],axis=1)}
          \PY{c+c1}{\PYZsh{} list\PYZus{}predictors = [\PYZsq{}logZ\PYZus{}sqft\PYZus{}living\PYZsq{},\PYZsq{}logZ\PYZus{}sqft\PYZus{}living15\PYZsq{},\PYZsq{}bedrooms\PYZsq{},\PYZsq{}bathrooms\PYZsq{},\PYZsq{}floors\PYZsq{}]}
          \PY{c+c1}{\PYZsh{} scaler = MinMaxScaler()}
          \PY{c+c1}{\PYZsh{} sel\PYZus{}columns = selected\PYZus{}features.index}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{c+c1}{\PYZsh{} Define X, Y }
          \PY{n}{X} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{try\PYZus{}modeling}\PY{p}{]}
          \PY{c+c1}{\PYZsh{} X.columns}
          
          \PY{n}{Y} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{c+c1}{\PYZsh{} y = df\PYZus{}run[\PYZsq{}logZ\PYZus{}price\PYZsq{}]}
          
          \PY{c+c1}{\PYZsh{} Get a list of predictor names string }
          \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
          \PY{n}{list\PYZus{}predictors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{intercept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{list\PYZus{}predictors}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}123}]:} ['codezipcode', 'grade', 'sca\_sqft\_living', 'sca\_sqft\_living15', 'intercept']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{c+c1}{\PYZsh{} Comcatenate X,Y for OLS}
          \PY{n}{df\PYZus{}run\PYZus{}ols} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{Y}\PY{p}{,}\PY{n}{X}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Import packages}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{stats}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sms}
          \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{smf}
          \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}
          
          \PY{c+c1}{\PYZsh{} Enter equation for selected predictors: (use C to run as categorical) }
          \PY{c+c1}{\PYZsh{} f1 = \PYZsq{}price\PYZti{}C(codezipcode)+C(grade)+sca\PYZus{}sqft\PYZus{}living+sca\PYZus{}sqft\PYZus{}living15\PYZsq{} \PYZsh{} 0.8 r1 Adjusted}
          \PY{n}{f1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price\PYZti{}C(codezipcode)+grade+sca\PYZus{}sqft\PYZus{}living+sca\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}} 
          
          \PY{c+c1}{\PYZsh{} Run model and report sumamry}
          \PY{n}{model} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{n}{formula}\PY{o}{=}\PY{n}{f1}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
          \PY{n}{model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}124}]:} <class 'statsmodels.iolib.summary.Summary'>
          """
                                      OLS Regression Results                            
          ==============================================================================
          Dep. Variable:                  price   R-squared:                       0.797
          Model:                            OLS   Adj. R-squared:                  0.796
          Method:                 Least Squares   F-statistic:                     1035.
          Date:                Wed, 13 Mar 2019   Prob (F-statistic):               0.00
          Time:                        17:21:14   Log-Likelihood:            -2.4441e+05
          No. Observations:               19053   AIC:                         4.890e+05
          Df Residuals:                   18980   BIC:                         4.895e+05
          Df Model:                          72                                         
          Covariance Type:            nonrobust                                         
          ========================================================================================
                                     coef    std err          t      P>|t|      [0.025      0.975]
          ----------------------------------------------------------------------------------------
          Intercept             5152.6368   8731.030      0.590      0.555    -1.2e+04    2.23e+04
          C(codezipcode)[T.1]   2.361e+04   8215.662      2.873      0.004    7503.139    3.97e+04
          C(codezipcode)[T.2]   2341.0236   7378.061      0.317      0.751   -1.21e+04    1.68e+04
          C(codezipcode)[T.3]   5.114e+05   8885.250     57.560      0.000    4.94e+05    5.29e+05
          C(codezipcode)[T.4]   3.405e+05   9150.155     37.213      0.000    3.23e+05    3.58e+05
          C(codezipcode)[T.5]   2.802e+05   6825.525     41.045      0.000    2.67e+05    2.94e+05
          C(codezipcode)[T.6]   2.573e+05   9464.329     27.187      0.000    2.39e+05    2.76e+05
          C(codezipcode)[T.7]   2.557e+05   7457.922     34.291      0.000    2.41e+05     2.7e+05
          C(codezipcode)[T.8]   1.054e+05   1.05e+04     10.074      0.000    8.49e+04    1.26e+05
          C(codezipcode)[T.9]   1.348e+05   8258.863     16.319      0.000    1.19e+05    1.51e+05
          C(codezipcode)[T.10]  1.282e+05   9852.210     13.014      0.000    1.09e+05    1.48e+05
          C(codezipcode)[T.11]  8.965e+04   8371.036     10.710      0.000    7.32e+04    1.06e+05
          C(codezipcode)[T.12]  4.869e+04   7811.281      6.234      0.000    3.34e+04     6.4e+04
          C(codezipcode)[T.13] -2.103e+04   6398.367     -3.287      0.001   -3.36e+04   -8487.932
          C(codezipcode)[T.14]  1.723e+05   1.21e+04     14.294      0.000    1.49e+05    1.96e+05
          C(codezipcode)[T.15]  1.893e+05   6900.034     27.438      0.000    1.76e+05    2.03e+05
          C(codezipcode)[T.16]  1.282e+05   7366.804     17.401      0.000    1.14e+05    1.43e+05
          C(codezipcode)[T.17]  2.198e+05   7223.982     30.430      0.000    2.06e+05    2.34e+05
          C(codezipcode)[T.18]   907.7456   7534.878      0.120      0.904   -1.39e+04    1.57e+04
          C(codezipcode)[T.19]  1.147e+04   7391.085      1.552      0.121   -3015.547     2.6e+04
          C(codezipcode)[T.20]  3234.7083   9600.539      0.337      0.736   -1.56e+04    2.21e+04
          C(codezipcode)[T.21]   3.27e+05   6873.901     47.578      0.000    3.14e+05    3.41e+05
          C(codezipcode)[T.22]  1.858e+05   6322.193     29.392      0.000    1.73e+05    1.98e+05
          C(codezipcode)[T.23]  3.341e+04   6189.647      5.398      0.000    2.13e+04    4.55e+04
          C(codezipcode)[T.24]  6.446e+05   3.72e+04     17.333      0.000    5.72e+05    7.17e+05
          C(codezipcode)[T.25]  4.396e+05   8998.802     48.846      0.000    4.22e+05    4.57e+05
          C(codezipcode)[T.26]  1.342e+04   6249.489      2.147      0.032    1166.174    2.57e+04
          C(codezipcode)[T.27]  1.194e+05   7939.547     15.036      0.000    1.04e+05    1.35e+05
          C(codezipcode)[T.28]  2.492e+05   6292.625     39.602      0.000    2.37e+05    2.62e+05
          C(codezipcode)[T.29]  2.347e+05   6937.430     33.827      0.000    2.21e+05    2.48e+05
          C(codezipcode)[T.30]   4.06e+04   7516.748      5.402      0.000    2.59e+04    5.53e+04
          C(codezipcode)[T.31]  1.093e+05   6693.020     16.330      0.000    9.62e+04    1.22e+05
          C(codezipcode)[T.32]  3.932e+04   6534.860      6.018      0.000    2.65e+04    5.21e+04
          C(codezipcode)[T.33]   9.51e+04   6589.751     14.431      0.000    8.22e+04    1.08e+05
          C(codezipcode)[T.34]  1.201e+05   7412.001     16.199      0.000    1.06e+05    1.35e+05
          C(codezipcode)[T.35]  1.975e+05   9885.649     19.982      0.000    1.78e+05    2.17e+05
          C(codezipcode)[T.36]  1.742e+05   7612.251     22.880      0.000    1.59e+05    1.89e+05
          C(codezipcode)[T.37]  2.137e+05   6770.358     31.559      0.000       2e+05    2.27e+05
          C(codezipcode)[T.38]  2.286e+05   7438.126     30.732      0.000    2.14e+05    2.43e+05
          C(codezipcode)[T.39]  1.781e+05   8684.281     20.503      0.000    1.61e+05    1.95e+05
          C(codezipcode)[T.40] -1.148e+04   6965.141     -1.648      0.099   -2.51e+04    2173.340
          C(codezipcode)[T.41]   4.05e+05   1.11e+04     36.408      0.000    3.83e+05    4.27e+05
          C(codezipcode)[T.42]  3.297e+05   6239.985     52.830      0.000    3.17e+05    3.42e+05
          C(codezipcode)[T.43]  3.908e+05   8585.748     45.522      0.000    3.74e+05    4.08e+05
          C(codezipcode)[T.44]  1.203e+05   7095.802     16.956      0.000    1.06e+05    1.34e+05
          C(codezipcode)[T.45]  3.252e+05   7546.464     43.096      0.000     3.1e+05     3.4e+05
          C(codezipcode)[T.46]  1.193e+05   8417.753     14.169      0.000    1.03e+05    1.36e+05
          C(codezipcode)[T.47]  4.236e+05   1.13e+04     37.566      0.000    4.01e+05    4.46e+05
          C(codezipcode)[T.48]  4.364e+05   8724.465     50.019      0.000    4.19e+05    4.53e+05
          C(codezipcode)[T.49]  3.271e+05   6266.348     52.207      0.000    3.15e+05    3.39e+05
          C(codezipcode)[T.50]   3.16e+05   7192.406     43.936      0.000    3.02e+05     3.3e+05
          C(codezipcode)[T.51]  3.237e+05   6318.347     51.230      0.000    3.11e+05    3.36e+05
          C(codezipcode)[T.52]  1.744e+05   6436.099     27.102      0.000    1.62e+05    1.87e+05
          C(codezipcode)[T.53]  4.177e+05   9094.361     45.931      0.000       4e+05    4.36e+05
          C(codezipcode)[T.54]  3.163e+05   7509.896     42.116      0.000    3.02e+05    3.31e+05
          C(codezipcode)[T.55]  2.019e+05   6737.030     29.975      0.000    1.89e+05    2.15e+05
          C(codezipcode)[T.56]  2.127e+05   6999.314     30.390      0.000    1.99e+05    2.26e+05
          C(codezipcode)[T.57]  1.563e+05   6413.853     24.371      0.000    1.44e+05    1.69e+05
          C(codezipcode)[T.58]  2.722e+05   7617.985     35.728      0.000    2.57e+05    2.87e+05
          C(codezipcode)[T.59]    2.5e+05   7152.431     34.956      0.000    2.36e+05    2.64e+05
          C(codezipcode)[T.60]  1.264e+05   7419.402     17.037      0.000    1.12e+05    1.41e+05
          C(codezipcode)[T.61]  5.933e+04   1.32e+04      4.489      0.000    3.34e+04    8.52e+04
          C(codezipcode)[T.62]  1.486e+05   6562.321     22.643      0.000    1.36e+05    1.61e+05
          C(codezipcode)[T.63]  1.299e+05   7685.234     16.905      0.000    1.15e+05    1.45e+05
          C(codezipcode)[T.64]  5.063e+04   7497.228      6.753      0.000    3.59e+04    6.53e+04
          C(codezipcode)[T.65]  2.276e+05   7840.903     29.027      0.000    2.12e+05    2.43e+05
          C(codezipcode)[T.66]  7.063e+04   7516.470      9.396      0.000    5.59e+04    8.54e+04
          C(codezipcode)[T.67]  3.793e+04   9456.808      4.011      0.000    1.94e+04    5.65e+04
          C(codezipcode)[T.68]  4.591e+04   7416.408      6.191      0.000    3.14e+04    6.05e+04
          C(codezipcode)[T.69]  3.666e+05   7441.021     49.269      0.000    3.52e+05    3.81e+05
          grade                 3.645e+04   1004.395     36.289      0.000    3.45e+04    3.84e+04
          sca\_sqft\_living       1.058e+05   1483.602     71.280      0.000    1.03e+05    1.09e+05
          sca\_sqft\_living15     3.646e+04   1505.741     24.213      0.000    3.35e+04    3.94e+04
          ==============================================================================
          Omnibus:                     2745.646   Durbin-Watson:                   2.000
          Prob(Omnibus):                  0.000   Jarque-Bera (JB):             8873.079
          Skew:                           0.739   Prob(JB):                         0.00
          Kurtosis:                       5.998   Cond. No.                         491.
          ==============================================================================
          
          Warnings:
          [1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
          """
\end{Verbatim}
            
    \hypertarget{final-model-for-validation}{%
\subsubsection{Final Model for
Validation:}\label{final-model-for-validation}}

\begin{Shaded}
\begin{Highlighting}[]
\OperatorTok{-}\NormalTok{ f1 }\OperatorTok{=} \StringTok{'price ~ C(codezipcode) + grade + sca_sqft_living + sca_sqft_living15'} 
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  price \textasciitilde{} zipcode(category), grade\sout{(category)},
  sqft\_living(scaled to median, RobustScaler) + sqft\_living15 (scaled
  to median, RobustScaler)
\end{itemize}

    \hypertarget{save-df_run_ols-to-csv}{%
\subsubsection{Save df\_run\_ols to csv}\label{save-df_run_ols-to-csv}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{n}{df\PYZus{}run\PYZus{}ols}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{df\PYZus{}run\PYZus{}ols\PYZus{}model.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{c+c1}{\PYZsh{} Visualize Q\PYZhy{}Q Plots}
          \PY{n}{resid1}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{resid}
          \PY{n}{fig} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{graphics}\PY{o}{.}\PY{n}{qqplot}\PY{p}{(}\PY{n}{resid1}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{p}{,} \PY{n}{line}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{45}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fit}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_194_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{itemize}
\tightlist
\item
  Interpreting the Q-Q plot:

  \begin{itemize}
  \tightlist
  \item
    The Q-Q plot looks a bit crazy and may indicate\ldots{} outliers?
  \item
    The only thing I did not check for outliers in final model was
    zipcode.
  \item
    Will run cross-validation with test-train-split to help decide
  \end{itemize}
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{c+c1}{\PYZsh{} Visualizing final dataset again.}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          
          \PY{c+c1}{\PYZsh{} Re\PYZhy{}inspecting XY}
          \PY{n}{plot\PYZus{}hist\PYZus{}scat}\PY{p}{(}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}127}]:}         0         1      2
          0  column  K\_square  p-val
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_196_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_196_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_196_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_196_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{new-regression-results}{%
\section{NEW REGRESSION RESULTS}\label{new-regression-results}}

    \hypertarget{k-fold-valiation-with-ols}{%
\subsection{K-Fold valiation with OLS}\label{k-fold-valiation-with-ols}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{c+c1}{\PYZsh{} k\PYZus{}fold\PYZus{}val\PYZus{}ols(X,y,k=10):}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}
          \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics} 
          
          \PY{n}{y} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          
          
          \PY{c+c1}{\PYZsh{} Run 10\PYZhy{}fold cross validation}
          \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{set\PYZsh{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}square\PYZus{}train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE\PYZus{}train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}square\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
          
          \PY{n}{num\PYZus{}coeff} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
          \PY{n}{list\PYZus{}predictors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{intercept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
          
          \PY{n}{reg\PYZus{}params} \PY{o}{=} \PY{p}{[}\PY{n}{list\PYZus{}predictors}\PY{p}{]}
          
          \PY{n}{i}\PY{o}{=}\PY{l+m+mi}{0}
          \PY{n}{k}\PY{o}{=}\PY{l+m+mi}{10}
          \PY{k}{while} \PY{n}{i} \PY{o}{\PYZlt{}}\PY{p}{(}\PY{n}{k}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
              \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)} \PY{c+c1}{\PYZsh{},stratify=[cat\PYZus{}col\PYZus{}names])}
          
              \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
              \PY{n}{f1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price\PYZti{}C(codezipcode)+grade+sca\PYZus{}sqft\PYZus{}living+sca\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}} 
              \PY{n}{model} \PY{o}{=} \PY{n}{smf}\PY{o}{.}\PY{n}{ols}\PY{p}{(}\PY{n}{formula}\PY{o}{=}\PY{n}{f1}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{data}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{p}{)}
              \PY{n}{model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
              
              \PY{n}{y\PYZus{}hat\PYZus{}train} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
              \PY{n}{y\PYZus{}hat\PYZus{}test} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
              \PY{n}{train\PYZus{}residuals} \PY{o}{=} \PY{n}{y\PYZus{}hat\PYZus{}train} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}train}
              \PY{n}{test\PYZus{}residuals} \PY{o}{=} \PY{n}{y\PYZus{}hat\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}test}
          
                  
              \PY{n}{train\PYZus{}mse} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}hat\PYZus{}train}\PY{p}{)}
              \PY{n}{test\PYZus{}mse} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}hat\PYZus{}test}\PY{p}{)}
          
              \PY{n}{R\PYZus{}sqare\PYZus{}train} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}hat\PYZus{}train}\PY{p}{)}
              \PY{n}{R\PYZus{}square\PYZus{}test} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}hat\PYZus{}test}\PY{p}{)}
          
              \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{R\PYZus{}sqare\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}mse}\PY{p}{,}\PY{n}{R\PYZus{}square\PYZus{}test}\PY{p}{,}\PY{n}{test\PYZus{}mse}\PY{p}{]}\PY{p}{)}
              \PY{n}{i}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
          
              
          \PY{n}{results} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{results}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
          \PY{n}{results}
          \PY{n}{model}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}128}]:} <class 'statsmodels.iolib.summary.Summary'>
          """
                                      OLS Regression Results                            
          ==============================================================================
          Dep. Variable:                  price   R-squared:                       0.798
          Model:                            OLS   Adj. R-squared:                  0.797
          Method:                 Least Squares   F-statistic:                     778.0
          Date:                Wed, 13 Mar 2019   Prob (F-statistic):               0.00
          Time:                        17:21:22   Log-Likelihood:            -1.8325e+05
          No. Observations:               14289   AIC:                         3.666e+05
          Df Residuals:                   14216   BIC:                         3.672e+05
          Df Model:                          72                                         
          Covariance Type:            nonrobust                                         
          ========================================================================================
                                     coef    std err          t      P>|t|      [0.025      0.975]
          ----------------------------------------------------------------------------------------
          Intercept             8571.8463   1.01e+04      0.849      0.396   -1.12e+04    2.84e+04
          C(codezipcode)[T.1]   2.404e+04   9531.426      2.522      0.012    5353.945    4.27e+04
          C(codezipcode)[T.2]   3261.6352   8550.648      0.381      0.703   -1.35e+04       2e+04
          C(codezipcode)[T.3]    5.16e+05   1.02e+04     50.685      0.000    4.96e+05    5.36e+05
          C(codezipcode)[T.4]   3.453e+05   1.04e+04     33.210      0.000    3.25e+05    3.66e+05
          C(codezipcode)[T.5]    2.83e+05   7851.685     36.047      0.000    2.68e+05    2.98e+05
          C(codezipcode)[T.6]   2.492e+05   1.08e+04     23.015      0.000    2.28e+05     2.7e+05
          C(codezipcode)[T.7]   2.544e+05   8611.089     29.543      0.000    2.38e+05    2.71e+05
          C(codezipcode)[T.8]    1.07e+05   1.22e+04      8.756      0.000     8.3e+04    1.31e+05
          C(codezipcode)[T.9]   1.374e+05   9481.164     14.497      0.000    1.19e+05    1.56e+05
          C(codezipcode)[T.10]  1.267e+05   1.15e+04     11.041      0.000    1.04e+05    1.49e+05
          C(codezipcode)[T.11]  8.851e+04   9609.368      9.210      0.000    6.97e+04    1.07e+05
          C(codezipcode)[T.12]  4.802e+04   9127.493      5.261      0.000    3.01e+04    6.59e+04
          C(codezipcode)[T.13] -2.421e+04   7395.412     -3.273      0.001   -3.87e+04   -9710.642
          C(codezipcode)[T.14]   1.69e+05   1.38e+04     12.237      0.000    1.42e+05    1.96e+05
          C(codezipcode)[T.15]  1.851e+05   7960.235     23.248      0.000    1.69e+05    2.01e+05
          C(codezipcode)[T.16]  1.291e+05   8358.907     15.448      0.000    1.13e+05    1.46e+05
          C(codezipcode)[T.17]   2.21e+05   8331.251     26.529      0.000    2.05e+05    2.37e+05
          C(codezipcode)[T.18]  2557.0641   8788.820      0.291      0.771   -1.47e+04    1.98e+04
          C(codezipcode)[T.19]  1.301e+04   8622.527      1.509      0.131   -3891.492    2.99e+04
          C(codezipcode)[T.20]  4807.4378   1.08e+04      0.444      0.657   -1.64e+04     2.6e+04
          C(codezipcode)[T.21]  3.272e+05   8040.413     40.692      0.000    3.11e+05    3.43e+05
          C(codezipcode)[T.22]  1.851e+05   7285.567     25.405      0.000    1.71e+05    1.99e+05
          C(codezipcode)[T.23]  3.666e+04   7097.164      5.165      0.000    2.27e+04    5.06e+04
          C(codezipcode)[T.24]  6.553e+05   4.07e+04     16.110      0.000    5.76e+05    7.35e+05
          C(codezipcode)[T.25]  4.352e+05   1.04e+04     41.847      0.000    4.15e+05    4.56e+05
          C(codezipcode)[T.26]  1.319e+04   7208.610      1.830      0.067    -936.613    2.73e+04
          C(codezipcode)[T.27]  1.233e+05   9129.895     13.500      0.000    1.05e+05    1.41e+05
          C(codezipcode)[T.28]  2.517e+05   7250.967     34.706      0.000    2.37e+05    2.66e+05
          C(codezipcode)[T.29]  2.364e+05   7981.599     29.613      0.000    2.21e+05    2.52e+05
          C(codezipcode)[T.30]  4.054e+04   8662.155      4.680      0.000    2.36e+04    5.75e+04
          C(codezipcode)[T.31]  1.092e+05   7703.745     14.179      0.000    9.41e+04    1.24e+05
          C(codezipcode)[T.32]  3.797e+04   7573.370      5.014      0.000    2.31e+04    5.28e+04
          C(codezipcode)[T.33]   9.59e+04   7602.413     12.615      0.000     8.1e+04    1.11e+05
          C(codezipcode)[T.34]  1.206e+05   8666.333     13.920      0.000    1.04e+05    1.38e+05
          C(codezipcode)[T.35]  1.957e+05   1.13e+04     17.284      0.000    1.74e+05    2.18e+05
          C(codezipcode)[T.36]  1.762e+05   8859.684     19.893      0.000    1.59e+05    1.94e+05
          C(codezipcode)[T.37]  2.153e+05   7794.178     27.620      0.000       2e+05    2.31e+05
          C(codezipcode)[T.38]  2.311e+05   8562.830     26.986      0.000    2.14e+05    2.48e+05
          C(codezipcode)[T.39]  1.818e+05   1.03e+04     17.628      0.000    1.62e+05    2.02e+05
          C(codezipcode)[T.40] -9124.4588   7934.730     -1.150      0.250   -2.47e+04    6428.650
          C(codezipcode)[T.41]  4.117e+05    1.3e+04     31.575      0.000    3.86e+05    4.37e+05
          C(codezipcode)[T.42]  3.272e+05   7240.512     45.194      0.000    3.13e+05    3.41e+05
          C(codezipcode)[T.43]   3.91e+05   9703.135     40.299      0.000    3.72e+05     4.1e+05
          C(codezipcode)[T.44]   1.15e+05   8159.107     14.097      0.000     9.9e+04    1.31e+05
          C(codezipcode)[T.45]  3.205e+05   8603.299     37.255      0.000    3.04e+05    3.37e+05
          C(codezipcode)[T.46]  1.224e+05   9780.679     12.511      0.000    1.03e+05    1.42e+05
          C(codezipcode)[T.47]  4.254e+05   1.34e+04     31.756      0.000    3.99e+05    4.52e+05
          C(codezipcode)[T.48]  4.322e+05   1.01e+04     42.827      0.000    4.12e+05    4.52e+05
          C(codezipcode)[T.49]  3.284e+05   7233.327     45.404      0.000    3.14e+05    3.43e+05
          C(codezipcode)[T.50]  3.145e+05   8306.871     37.854      0.000    2.98e+05    3.31e+05
          C(codezipcode)[T.51]  3.267e+05   7338.030     44.528      0.000    3.12e+05    3.41e+05
          C(codezipcode)[T.52]  1.777e+05   7435.911     23.900      0.000    1.63e+05    1.92e+05
          C(codezipcode)[T.53]  4.197e+05   1.09e+04     38.421      0.000    3.98e+05    4.41e+05
          C(codezipcode)[T.54]  3.073e+05   8807.524     34.892      0.000     2.9e+05    3.25e+05
          C(codezipcode)[T.55]  2.014e+05   7775.132     25.907      0.000    1.86e+05    2.17e+05
          C(codezipcode)[T.56]   2.09e+05   7936.931     26.328      0.000    1.93e+05    2.25e+05
          C(codezipcode)[T.57]  1.564e+05   7443.538     21.015      0.000    1.42e+05    1.71e+05
          C(codezipcode)[T.58]  2.669e+05   8829.706     30.224      0.000     2.5e+05    2.84e+05
          C(codezipcode)[T.59]  2.439e+05   8248.349     29.566      0.000    2.28e+05     2.6e+05
          C(codezipcode)[T.60]  1.253e+05   8563.302     14.634      0.000    1.09e+05    1.42e+05
          C(codezipcode)[T.61]  5.391e+04   1.48e+04      3.631      0.000    2.48e+04     8.3e+04
          C(codezipcode)[T.62]   1.46e+05   7624.172     19.143      0.000    1.31e+05    1.61e+05
          C(codezipcode)[T.63]  1.319e+05   8818.023     14.955      0.000    1.15e+05    1.49e+05
          C(codezipcode)[T.64]   5.03e+04   8748.000      5.749      0.000    3.31e+04    6.74e+04
          C(codezipcode)[T.65]  2.275e+05   9116.435     24.955      0.000     2.1e+05    2.45e+05
          C(codezipcode)[T.66]  7.114e+04   8558.531      8.312      0.000    5.44e+04    8.79e+04
          C(codezipcode)[T.67]  3.477e+04   1.09e+04      3.200      0.001    1.35e+04    5.61e+04
          C(codezipcode)[T.68]  4.288e+04   8562.091      5.009      0.000    2.61e+04    5.97e+04
          C(codezipcode)[T.69]  3.727e+05   8623.381     43.222      0.000    3.56e+05     3.9e+05
          grade                 3.603e+04   1160.047     31.058      0.000    3.38e+04    3.83e+04
          sca\_sqft\_living       1.055e+05   1705.568     61.857      0.000    1.02e+05    1.09e+05
          sca\_sqft\_living15     3.648e+04   1745.227     20.903      0.000    3.31e+04    3.99e+04
          ==============================================================================
          Omnibus:                     2217.849   Durbin-Watson:                   2.037
          Prob(Omnibus):                  0.000   Jarque-Bera (JB):             7229.365
          Skew:                           0.791   Prob(JB):                         0.00
          Kurtosis:                       6.105   Cond. No.                         489.
          ==============================================================================
          
          Warnings:
          [1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
          """
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{n}{results}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}129}]:}     set\#  R\_square\_train     MSE\_train  R\_square\_test      MSE\_test
          0      0        0.795687  8.169995e+09       0.799673  8.010727e+09
          1      1        0.794860  8.110302e+09       0.801763  8.194693e+09
          2      2        0.795824  8.212547e+09       0.799305  7.882239e+09
          3      3        0.797886  8.073421e+09       0.792904  8.299344e+09
          4      4        0.796680  8.116801e+09       0.796566  8.174088e+09
          5      5        0.796311  8.161392e+09       0.797758  8.038536e+09
          6      6        0.794035  8.158237e+09       0.804212  8.050524e+09
          7      7        0.796673  8.153066e+09       0.796832  8.057432e+09
          8      8        0.796357  8.145779e+09       0.797871  8.075713e+09
          9      9        0.794824  8.235756e+09       0.802531  7.806805e+09
          10    10        0.797589  8.065537e+09       0.794279  8.310341e+09
\end{Verbatim}
            
    \hypertarget{q-q-plots}{%
\subsection{Q-Q Plots}\label{q-q-plots}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}130}]:} \PY{n}{resid1}\PY{o}{=}\PY{n}{model}\PY{o}{.}\PY{n}{resid}
          \PY{n}{fig} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{graphics}\PY{o}{.}\PY{n}{qqplot}\PY{p}{(}\PY{n}{resid1}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{p}{,} \PY{n}{line}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{45}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fit}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_202_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}131}]:} \PY{n}{df\PYZus{}model} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{try\PYZus{}modeling}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} df\PYZus{}model.to\PYZus{}csv(\PYZsq{}df\PYZus{}housing\PYZus{}model.csv\PYZsq{})}
          \PY{c+c1}{\PYZsh{} df\PYZus{}run.to\PYZus{}csv(\PYZsq{}df\PYZus{}house\PYZus{}all\PYZus{}final\PYZus{}data.csv\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}132}]:} \PY{n}{results}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}132}]:}             set\#  R\_square\_train     MSE\_train  R\_square\_test      MSE\_test
          count  11.000000       11.000000  1.100000e+01      11.000000  1.100000e+01
          mean    5.000000        0.796066  8.145712e+09       0.798518  8.081858e+09
          std     3.316625        0.001177  5.231161e+07       0.003437  1.564599e+08
          min     0.000000        0.794035  8.065537e+09       0.792904  7.806805e+09
          25\%     2.500000        0.795274  8.113552e+09       0.796699  8.024631e+09
          50\%     5.000000        0.796311  8.153066e+09       0.797871  8.057432e+09
          75\%     7.500000        0.796677  8.165694e+09       0.800718  8.184390e+09
          max    10.000000        0.797886  8.235756e+09       0.804212  8.310341e+09
\end{Verbatim}
            
    \hypertarget{final-model---new}{%
\section{FINAL MODEL - New}\label{final-model---new}}

\begin{itemize}
\tightlist
\item
  For k=10 fold validation, with price as target variable:

  \begin{itemize}
  \tightlist
  \item
    mean r\_squared for the test sets was 0.797, with mean MSE =
    8.158691e+09
  \end{itemize}

  f1 =
  `price\textasciitilde{}C(codezipcode)+C(grade)+sca\_sqft\_living+sca\_sqft\_living15'
\item
  Predictors in final model:

  \begin{itemize}
  \tightlist
  \item
    `Zipcode'
  \item
    `grade'
  \item
    `sqft\_living'
  \item
    `sqfr\_living15'
  \end{itemize}
\item
  My final model indicates that the size, location, and housing geade to
  be critical components in determining salesprice.
\end{itemize}

    \hypertarget{predictor-coefficients-their-affect-on-sales-price}{%
\subsection{Predictor Coefficients \& Their Affect On Sales
Price}\label{predictor-coefficients-their-affect-on-sales-price}}

\begin{itemize}
\tightlist
\item
  Grade, sqft\_living, and sqft\_living15 all have straight-forward
  relationships with sales price, with positive coefficients.

  \begin{itemize}
  \tightlist
  \item
    sqft\_living is a larger component of the price (coefficient:
    1.043e+05)
  \item
    grade (coeff: 3.679e+04)and sqft\_living15 (coeff: 3.767e+04) have a
    similar magnitude of an effect on sales price
  \end{itemize}
\item
  Zipcode is a bit trickier, as each zipcode has its own coefficient.

  \begin{itemize}
  \tightlist
  \item
    Overall, zipcode has a positive coefficient/effect on price (to
    varying degrees)
  \item
    There are, however, a couple zipcodes that negatively impact sales
    price.
  \end{itemize}
\end{itemize}

    \hypertarget{future-directions}{%
\subsection{Future Directions}\label{future-directions}}

\begin{itemize}
\tightlist
\item
  \textbf{With more time I would have proceeded to perform the following
  steps:}

  \begin{itemize}
  \tightlist
  \item
    Additional changes to the predictors in the model

    \begin{itemize}
    \tightlist
    \item
      Trying to remove outliers from zipcodes
    \end{itemize}
  \item
    Explored additional transformations to the data.

    \begin{itemize}
    \tightlist
    \item
      I was trying to be conservative to keep the interpretability of my
      model intact.
    \item
      Log-transforming the data improved the distributions but made it
      more difficult to interpret.
    \end{itemize}
  \item
    I would further tweak the quality of the visuals, particularly
    changing the x-tick labels and rotation.
  \end{itemize}
\end{itemize}

    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\hypertarget{summary-figures-for-presentation}{%
\section{SUMMARY FIGURES FOR
PRESENTATION}\label{summary-figures-for-presentation}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dark\PYZus{}background}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} figSum, ax = plt.subplots(nrows=2,ncols=2,figsize=(16,16),sharey=True)}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{nrows}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{sharey}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} The amount of space above titles}
          \PY{c+c1}{\PYZsh{} y\PYZus{}title\PYZus{}margin = 1}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Critical Factors for Predicting Sales Price}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+m+mf}{1.0}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{22}\PY{p}{)}
          
          \PY{n}{i}\PY{o}{=}\PY{l+m+mi}{0}
          \PY{n}{j}\PY{o}{=}\PY{l+m+mi}{0}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Zipcodes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{c+c1}{\PYZsh{}, y = y\PYZus{}title\PYZus{}margin)}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}fontsize}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{stripplot}\PY{p}{(}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{codezipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
          
          \PY{n}{i}\PY{o}{=}\PY{l+m+mi}{0}
          \PY{n}{j}\PY{o}{=}\PY{l+m+mi}{1}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Grade}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{c+c1}{\PYZsh{} y = y\PYZus{}title\PYZus{}margin)}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}fontsize}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{stripplot}\PY{p}{(}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grade}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
          
          \PY{n}{i}\PY{o}{=}\PY{l+m+mi}{1}
          \PY{n}{j}\PY{o}{=}\PY{l+m+mi}{0}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Living Space (sqft)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{c+c1}{\PYZsh{}, y = y\PYZus{}title\PYZus{}margin)}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}fontsize}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{stripplot}\PY{p}{(}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sca\PYZus{}sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{},marker=\PYZsq{}o\PYZsq{},size=2)}
          
          \PY{n}{i}\PY{o}{=}\PY{l+m+mi}{1}
          \PY{n}{j}\PY{o}{=}\PY{l+m+mi}{1}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Living Space (sqft)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{c+c1}{\PYZsh{}, y = y\PYZus{}title\PYZus{}margin)}
          \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}fontsize}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{stripplot}\PY{p}{(}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sca\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}run\PYZus{}ols}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{j}\PY{p}{]}\PY{p}{,}\PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{c+c1}{\PYZsh{},size=2)}
          \PY{c+c1}{\PYZsh{} axes[0,0]=}
          \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_209_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{n}{df\PYZus{}run\PYZus{}ols}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 19053 entries, 0 to 21596
Data columns (total 5 columns):
price                19053 non-null float64
codezipcode          19053 non-null category
grade                19053 non-null int64
sca\_sqft\_living      19053 non-null float64
sca\_sqft\_living15    19053 non-null float64
dtypes: category(1), float64(3), int64(1)
memory usage: 1.4 MB

    \end{Verbatim}

    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

    \hypertarget{original-regression-from-first-iteration}{%
\section{ORIGINAL REGRESSION FROM FIRST
ITERATION}\label{original-regression-from-first-iteration}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} DEFINING FUNCTION TO RUN K\PYZhy{}FOLD VALIDATION}
        \PY{k}{def} \PY{n+nf}{k\PYZus{}fold\PYZus{}val}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{k}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{QQ}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
            \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
            \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}
            \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics} 
        
            \PY{c+c1}{\PYZsh{} Run 10\PYZhy{}fold cross validation}
            \PY{n}{i}\PY{o}{=}\PY{l+m+mi}{0}
            \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{set\PYZsh{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}square\PYZus{}train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE\PYZus{}train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}square\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
            
            \PY{n}{num\PYZus{}coeff} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            
            \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
            \PY{n}{list\PYZus{}predictors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{intercept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
            
            \PY{n}{reg\PYZus{}params} \PY{o}{=} \PY{p}{[}\PY{n}{list\PYZus{}predictors}\PY{p}{]}
            
            
            \PY{k}{while} \PY{n}{i} \PY{o}{\PYZlt{}}\PY{p}{(}\PY{n}{k}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)} \PY{c+c1}{\PYZsh{},stratify=[cat\PYZus{}col\PYZus{}names])}
        
        
                \PY{n}{linreg} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
                \PY{n}{linreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
        
        
                \PY{n}{y\PYZus{}hat\PYZus{}train} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
                \PY{n}{y\PYZus{}hat\PYZus{}test} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
        
                \PY{n}{train\PYZus{}residuals} \PY{o}{=} \PY{n}{y\PYZus{}hat\PYZus{}train} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}train}
                \PY{n}{test\PYZus{}residuals} \PY{o}{=} \PY{n}{y\PYZus{}hat\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}test}
                
        \PY{c+c1}{\PYZsh{}         if QQ ==True:}
        \PY{c+c1}{\PYZsh{} \PYZsh{}             fig = sm.graphics.qqplot(train\PYZus{}residuals, dist=stats.norm, line=\PYZsq{}45\PYZsq{}, fit=True) }
        \PY{c+c1}{\PYZsh{} \PYZsh{}             fig=figure(figsize=(12,12)}
        \PY{c+c1}{\PYZsh{} \PYZsh{}             plt.figure()}
        \PY{c+c1}{\PYZsh{}             fig, ax = sm.graphics.qqplot(test\PYZus{}residuals, dist=stats.norm, line=\PYZsq{}45\PYZsq{}, fit=True)}
        \PY{c+c1}{\PYZsh{}             ax.set\PYZus{}title(\PYZsq{}Test Residuals\PYZsq{})}
        \PY{c+c1}{\PYZsh{}             plt.show()}
                
                \PY{n}{train\PYZus{}mse} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}hat\PYZus{}train}\PY{p}{)}
                \PY{n}{test\PYZus{}mse} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}hat\PYZus{}test}\PY{p}{)}
        
                \PY{n}{R\PYZus{}sqare\PYZus{}train} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}hat\PYZus{}train}\PY{p}{)}
                \PY{n}{R\PYZus{}square\PYZus{}test} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}hat\PYZus{}test}\PY{p}{)}
        
                \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{R\PYZus{}sqare\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}mse}\PY{p}{,}\PY{n}{R\PYZus{}square\PYZus{}test}\PY{p}{,}\PY{n}{test\PYZus{}mse}\PY{p}{]}\PY{p}{)}
                \PY{n}{params\PYZus{}to\PYZus{}add} \PY{o}{=} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{linreg}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{]}
                \PY{n}{params\PYZus{}to\PYZus{}add}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{linreg}\PY{o}{.}\PY{n}{intercept\PYZus{}}\PY{p}{)}
                \PY{n}{reg\PYZus{}params}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{params\PYZus{}to\PYZus{}add}\PY{p}{)}
        
                \PY{n}{i} \PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
            
        
            \PY{n}{df\PYZus{}res}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
            \PY{n}{df\PYZus{}res}\PY{o}{.}\PY{n}{columns}\PY{o}{=}\PY{n}{df\PYZus{}res}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{df\PYZus{}res} \PY{o}{=} \PY{n}{df\PYZus{}res}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
            
            \PY{n}{df\PYZus{}params} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{reg\PYZus{}params}\PY{p}{)}
            \PY{n}{df\PYZus{}params}\PY{o}{.}\PY{n}{columns}\PY{o}{=}\PY{n}{df\PYZus{}params}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{df\PYZus{}params} \PY{o}{=} \PY{n}{df\PYZus{}params}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
        
            \PY{n}{r2\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{df\PYZus{}res}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
            \PY{n}{MSE\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{df\PYZus{}res}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
            
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{For k=}\PY{l+s+si}{\PYZob{}k\PYZcb{}}\PY{l+s+s1}{: mean r2 = }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{round(r2\PYZus{}test,3)\PYZcb{}, mean MSE = }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{round(MSE\PYZus{}test,3)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{k}{return} \PY{n}{df\PYZus{}res}\PY{p}{,} \PY{n}{df\PYZus{}params}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Output 1:}
        \PY{n}{df\PYZus{}res}\PY{p}{,}\PY{n}{df\PYZus{}params} \PY{o}{=} \PY{n}{k\PYZus{}fold\PYZus{}val}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{QQ}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{df\PYZus{}res}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{df\PYZus{}params}
\end{Verbatim}


    \textbf{Output 1:} - Predictors : -
logZ\_sqft\_living',`logZ\_sqft\_living15',`bedrooms',`bathrooms',`floors',
cat\_grade, cat\_view, cat\_bins\_sqftabove, cat\_bins\_sqftbasement{]}
- For k=10: mean r2 = 0.595, mean MSE = 0.407 - X\_cats =
df\_run{[}{[}`logZ\_sqft\_living',`logZ\_sqft\_living15',`bedrooms',`bathrooms',`floors',
`cat\_grade', `cat\_view',\\
`cat\_bins\_sqftabove', `cat\_bins\_sqftbasement'{]}{]} - Realized did
not have zipcodes included, adding to model and trying again.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} MODEL \PYZsh{}2}
        \PY{c+c1}{\PYZsh{} PUTTING TOGETHER THE PREDICTORS TO RUN IN THE REGRESSION}
        \PY{c+c1}{\PYZsh{}\PYZsh{} Last min dummy vars []\PYZsq{}cat\PYZus{}grade\PYZsq{},\PYZsq{}cat\PYZus{}zipcode\PYZsq{},\PYZsq{}cat\PYZus{}view\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}above\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}basement\PYZsq{}]}
        \PY{n}{dum\PYZus{}grades} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}grade}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}view} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}above} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftabove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftAb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}base} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftBa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}zipcodes} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}zipcode}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} RUNNING K\PYZhy{}FOLD VALIDATION.}
        \PY{c+c1}{\PYZsh{} X = df\PYZus{}run.drop([\PYZsq{}price\PYZsq{},\PYZsq{}logZ\PYZus{}price\PYZsq{}],axis=1)}
        \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{floors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{list\PYZus{}predictors}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X}\PY{p}{,}\PY{n}{dum\PYZus{}grades}\PY{p}{,}\PY{n}{dum\PYZus{}view}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}above}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}base}\PY{p}{,}\PY{n}{dum\PYZus{}zipcodes}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}dum\PYZus{}bedrooms}
        \PY{n}{y} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} Output 2:}
        \PY{n}{df\PYZus{}res}\PY{p}{,}\PY{n}{df\PYZus{}params} \PY{o}{=} \PY{n}{k\PYZus{}fold\PYZus{}val}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)}
        \PY{n}{df\PYZus{}res}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{df\PYZus{}params}
\end{Verbatim}


    \textbf{Output 2:} - Predictors : -
df\_run{[}{[}`logZ\_sqft\_living',`logZ\_sqft\_living15',`bedrooms',`bathrooms',`floors',
`cat\_grade', `cat\_view',\\
`cat\_bins\_sqftabove', `cat\_bins\_sqftbasement',`cat\_zipcode'{]}{]}

\begin{itemize}
\item
  For k=10: mean r2 = -5.98119975258282e+20, mean MSE =
  5.910069200674956e+20
\item
  Clearly adding zipcodes in was a mistake. I wasn't aware you could get
  a negative R-square value
\item
  For next iteration, will remove zipcodes, and will remove
  logZ\_sqft\_living since had correlation with sqftabove
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} MODEL \PYZsh{}3}
        \PY{c+c1}{\PYZsh{} PUTTING TOGETHER THE PREDICTORS TO RUN IN THE REGRESSION}
        \PY{c+c1}{\PYZsh{}\PYZsh{} Last min dummy vars []\PYZsq{}cat\PYZus{}grade\PYZsq{},\PYZsq{}cat\PYZus{}zipcode\PYZsq{},\PYZsq{}cat\PYZus{}view\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}above\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}basement\PYZsq{}]}
        \PY{n}{dum\PYZus{}grades} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}grade}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}view} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}above} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftabove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftAb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}base} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftBa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{c+c1}{\PYZsh{} dum\PYZus{}zipcodes = pd.get\PYZus{}dummies(df\PYZus{}run[\PYZsq{}cat\PYZus{}zipcode\PYZsq{}],prefix=\PYZsq{}zip\PYZsq{}).iloc[:,:\PYZhy{}1]}
        
        \PY{c+c1}{\PYZsh{} RUNNING K\PYZhy{}FOLD VALIDATION.}
        \PY{c+c1}{\PYZsh{} X = df\PYZus{}run.drop([\PYZsq{}price\PYZsq{},\PYZsq{}logZ\PYZus{}price\PYZsq{}],axis=1)}
        \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{floors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{list\PYZus{}predictors}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X}\PY{p}{,}\PY{n}{dum\PYZus{}grades}\PY{p}{,}\PY{n}{dum\PYZus{}view}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}above}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}base}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}dum\PYZus{}bedrooms}
        \PY{n}{y} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} Output 3:}
        \PY{n}{df\PYZus{}res}\PY{p}{,}\PY{n}{df\PYZus{}params} \PY{o}{=} \PY{n}{k\PYZus{}fold\PYZus{}val}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)}
        \PY{n}{df\PYZus{}res}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{df\PYZus{}params}
\end{Verbatim}


    \textbf{Output 3:} - For k=10: mean r2 = 0.585, mean MSE = 0.408 -
Slightly worse than original model. - Adding back sqft\_living, removing
floors

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} MODEL \PYZsh{}4}
        \PY{c+c1}{\PYZsh{} PUTTING TOGETHER THE PREDICTORS TO RUN IN THE REGRESSION}
        \PY{c+c1}{\PYZsh{}\PYZsh{} Last min dummy vars []\PYZsq{}cat\PYZus{}grade\PYZsq{},\PYZsq{}cat\PYZus{}zipcode\PYZsq{},\PYZsq{}cat\PYZus{}view\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}above\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}basement\PYZsq{}]}
        \PY{n}{dum\PYZus{}grades} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}grade}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}view} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}above} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftabove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftAb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}base} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftBa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{c+c1}{\PYZsh{} dum\PYZus{}zipcodes = pd.get\PYZus{}dummies(df\PYZus{}run[\PYZsq{}cat\PYZus{}zipcode\PYZsq{}],prefix=\PYZsq{}zip\PYZsq{}).iloc[:,:\PYZhy{}1]}
        
        \PY{c+c1}{\PYZsh{} RUNNING K\PYZhy{}FOLD VALIDATION.}
        \PY{c+c1}{\PYZsh{} X = df\PYZus{}run.drop([\PYZsq{}price\PYZsq{},\PYZsq{}logZ\PYZus{}price\PYZsq{}],axis=1)}
        \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{list\PYZus{}predictors}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X}\PY{p}{,}\PY{n}{dum\PYZus{}grades}\PY{p}{,}\PY{n}{dum\PYZus{}view}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}above}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}base}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}dum\PYZus{}bedrooms}
        \PY{n}{y} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} Output 4:}
        \PY{n}{df\PYZus{}res}\PY{p}{,}\PY{n}{df\PYZus{}params} \PY{o}{=} \PY{n}{k\PYZus{}fold\PYZus{}val}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)}
        \PY{n}{df\PYZus{}res}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{df\PYZus{}params}
\end{Verbatim}


    \textbf{Output 4:} - For k=10: mean r2 = 0.589, mean MSE = 0.411 -
slightly worse than original model - add back floors - add waterfront

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Model 5: }
        \PY{c+c1}{\PYZsh{} PUTTING TOGETHER THE PREDICTORS TO RUN IN THE REGRESSION}
        \PY{c+c1}{\PYZsh{}\PYZsh{} Last min dummy vars []\PYZsq{}cat\PYZus{}grade\PYZsq{},\PYZsq{}cat\PYZus{}zipcode\PYZsq{},\PYZsq{}cat\PYZus{}view\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}above\PYZsq{},\PYZsq{}cat\PYZus{}bins\PYZus{}sqft\PYZus{}basement\PYZsq{}]}
        \PY{n}{dum\PYZus{}grades} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}grade}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}view} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{view}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}above} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftabove}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftAb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}sqft\PYZus{}base} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}bins\PYZus{}sqftbasement}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqftBa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{dum\PYZus{}waterfront} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cat\PYZus{}waterfront}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{prefix}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        
        
        \PY{c+c1}{\PYZsh{} RUNNING K\PYZhy{}FOLD VALIDATION WITH STATSMODELS OLS.}
        \PY{c+c1}{\PYZsh{} X = df\PYZus{}run.drop([\PYZsq{}price\PYZsq{},\PYZsq{}logZ\PYZus{}price\PYZsq{}],axis=1)}
        \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}sqft\PYZus{}living}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}sqft\PYZus{}living15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bedrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bathrooms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{floors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{n}{list\PYZus{}predictors}\PY{p}{]}
        \PY{n}{X} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X}\PY{p}{,}\PY{n}{dum\PYZus{}grades}\PY{p}{,}\PY{n}{dum\PYZus{}view}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}above}\PY{p}{,}\PY{n}{dum\PYZus{}sqft\PYZus{}base}\PY{p}{,}\PY{n}{dum\PYZus{}waterfront}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}dum\PYZus{}bedrooms}
        \PY{n}{y} \PY{o}{=} \PY{n}{df\PYZus{}run}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logZ\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} Output 5:}
        \PY{n}{df\PYZus{}res}\PY{p}{,}\PY{n}{df\PYZus{}params} \PY{o}{=} \PY{n}{k\PYZus{}fold\PYZus{}val}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)}
        \PY{n}{df\PYZus{}res}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{df\PYZus{}params}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{df\PYZus{}params}
\end{Verbatim}


    \textbf{Output 5:} - For k=10: mean r2 = 0.596, mean MSE = 0.405 - Ever
so slightly better than initial model. - Do not have additional time to
try other models.

    \hypertarget{regression-diagnostics}{%
\subsection{Regression Diagnostics}\label{regression-diagnostics}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}\PYZsh{} REGRESSION FUNCTION}
        \PY{c+c1}{\PYZsh{} DEFINING FUNCTION TO RUN K\PYZhy{}FOLD VALIDATION}
        \PY{k}{def} \PY{n+nf}{k\PYZus{}fold\PYZus{}val}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{k}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
            \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
            \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}
            \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics} 
        
            \PY{c+c1}{\PYZsh{} Run 10\PYZhy{}fold cross validation}
            \PY{n}{i}\PY{o}{=}\PY{l+m+mi}{0}
            \PY{n}{results} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{set\PYZsh{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}square\PYZus{}train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE\PYZus{}train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{R\PYZus{}square\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
            \PY{n}{residuals}\PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}train}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y\PYZus{}test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train\PYZus{}residuals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}residuals}\PY{l+s+s1}{\PYZsq{}} \PY{p}{]}\PY{p}{]}
           
            \PY{n}{num\PYZus{}coeff} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            
            \PY{n}{list\PYZus{}predictors} \PY{o}{=} \PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{X}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
            \PY{c+c1}{\PYZsh{} reg\PYZus{}params = [\PYZsq{}intercept\PYZsq{}]}
            \PY{c+c1}{\PYZsh{} reg\PYZus{}params.append(list\PYZus{}predictors)}
            \PY{n}{list\PYZus{}predictors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{intercept}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
            \PY{n}{reg\PYZus{}params} \PY{o}{=} \PY{p}{[}\PY{n}{list\PYZus{}predictors}\PY{p}{]}
            \PY{k}{while} \PY{n}{i} \PY{o}{\PYZlt{}}\PY{p}{(}\PY{n}{k}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{)} \PY{c+c1}{\PYZsh{},stratify=[cat\PYZus{}col\PYZus{}names])}
        
        
                \PY{n}{linreg} \PY{o}{=} \PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}
                \PY{n}{linreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
        
        
                \PY{n}{y\PYZus{}hat\PYZus{}train} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
                \PY{n}{y\PYZus{}hat\PYZus{}test} \PY{o}{=} \PY{n}{linreg}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
        
                \PY{n}{train\PYZus{}residuals} \PY{o}{=} \PY{n}{y\PYZus{}hat\PYZus{}train} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}train}
                \PY{n}{test\PYZus{}residuals} \PY{o}{=} \PY{n}{y\PYZus{}hat\PYZus{}test} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}test}
                
        
                
                
                \PY{n}{train\PYZus{}mse} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}hat\PYZus{}train}\PY{p}{)}
                \PY{n}{test\PYZus{}mse} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}hat\PYZus{}test}\PY{p}{)}
        
                \PY{n}{R\PYZus{}sqare\PYZus{}train} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}hat\PYZus{}train}\PY{p}{)}
                \PY{n}{R\PYZus{}square\PYZus{}test} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{r2\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}hat\PYZus{}test}\PY{p}{)}
        
                \PY{n}{results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{R\PYZus{}sqare\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}mse}\PY{p}{,}\PY{n}{R\PYZus{}square\PYZus{}test}\PY{p}{,}\PY{n}{test\PYZus{}mse}\PY{p}{]}\PY{p}{)}
                \PY{n}{params\PYZus{}to\PYZus{}add} \PY{o}{=} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{linreg}\PY{o}{.}\PY{n}{coef\PYZus{}}\PY{p}{]}
                \PY{n}{params\PYZus{}to\PYZus{}add}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{linreg}\PY{o}{.}\PY{n}{intercept\PYZus{}}\PY{p}{)}
                \PY{n}{reg\PYZus{}params}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{params\PYZus{}to\PYZus{}add}\PY{p}{)}
                
                \PY{n}{i} \PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
            \PY{k}{if} 
                \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
                \PY{n}{fig} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{graphics}\PY{o}{.}\PY{n}{qqplot}\PY{p}{(}\PY{n}{train\PYZus{}residuals}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{p}{,} \PY{n}{line}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{45}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fit}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                \PY{n}{fig} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{graphics}\PY{o}{.}\PY{n}{qqplot}\PY{p}{(}\PY{n}{test\PYZus{}residuals}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{p}{,} \PY{n}{line}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{45}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fit}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
            \PY{n}{df\PYZus{}res}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results}\PY{p}{)}
            \PY{n}{df\PYZus{}reg\PYZus{}params} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{reg\PYZus{}params}\PY{p}{)}
        
            \PY{n}{r2\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{df\PYZus{}res}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
            \PY{n}{MSE\PYZus{}test} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{df\PYZus{}res}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
            
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{For k=}\PY{l+s+si}{\PYZob{}k\PYZcb{}}\PY{l+s+s1}{: mean r2 = }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{round(r2\PYZus{}test,3)\PYZcb{}, mean MSE = }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{round(MSE\PYZus{}test,3)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
            \PY{k}{return} \PY{n}{df\PYZus{}res}\PY{p}{,} \PY{n}{df\PYZus{}reg\PYZus{}params}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sm}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{stats}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{sms}
        \PY{k+kn}{import} \PY{n+nn}{statsmodels}\PY{n+nn}{.}\PY{n+nn}{formula}\PY{n+nn}{.}\PY{n+nn}{api} \PY{k}{as} \PY{n+nn}{smf}
        \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{stats}
        \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fivethirtyeight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Advertising.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} f = \PYZsq{}sales\PYZti{}TV\PYZsq{}}
        \PY{c+c1}{\PYZsh{} f2 = \PYZsq{}sales\PYZti{}radio\PYZsq{}}
        \PY{c+c1}{\PYZsh{} model = smf.ols(formula=f, data=data).fit()}
        \PY{c+c1}{\PYZsh{} model2 = smf.ols(formula=f2, data=data).fit()}
        \PY{c+c1}{\PYZsh{}}
        \PY{n}{resid1} \PY{o}{=} 
        \PY{n}{resid2} \PY{o}{=}
        \PY{n}{resid1} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{resid}
        \PY{n}{resid2} \PY{o}{=} \PY{n}{model2}\PY{o}{.}\PY{n}{resid}
        \PY{n}{fig} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{graphics}\PY{o}{.}\PY{n}{qqplot}\PY{p}{(}\PY{n}{resid1}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{p}{,} \PY{n}{line}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{45}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fit}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}   \PY{p}{)}
        \PY{n}{fig} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{graphics}\PY{o}{.}\PY{n}{qqplot}\PY{p}{(}\PY{n}{resid2}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{n}{stats}\PY{o}{.}\PY{n}{norm}\PY{p}{,} \PY{n}{line}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{45}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fit}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{fig}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \hypertarget{final-model-original}{%
\subsection{Final Model (original)}\label{final-model-original}}

\begin{itemize}
\tightlist
\item
  For k=10 fold validation, with logZ\_price as target variable:

  \begin{itemize}
  \tightlist
  \item
    mean r2 = 0.596, mean MSE = 0.405
  \end{itemize}
\item
  Predictors in final model:

  \begin{itemize}
  \tightlist
  \item
    `logZ\_sqft\_living'
  \item
    `logZ\_sqft\_living15'
  \item
    `bedrooms'
  \item
    `bathrooms'
  \item
    `floors'
  \item
    grade
  \item
    view
  \item
    sqft\_above
  \item
    sqft\_basement
  \item
    waterfront
  \end{itemize}
\item
  My final model indicates that several aspects of the size of the house
  are important for determining price: (sqft) of the living areas, as
  well as the presence/size of basements, in addition to the \# of
  floors, bedrooms, and bathrooms. Additionally, more qualitative
  aspects of the neighborhood/area also play and important role, such as
  if the house is waterfront property, the aesthetic quality of the
  view, as well as housing-grade
\end{itemize}

    \hypertarget{predictor-coefficients-their-affect-on-sales-price}{%
\subsection{Predictor Coefficients \& Their Affect On Sales
Price}\label{predictor-coefficients-their-affect-on-sales-price}}

\begin{itemize}
\tightlist
\item
  I admittedly do not know how to interpret the coefficients for
  dummy-coded variables, part of why I tried desperately to avoid them
  but couldn't resolve the sparse class issue when attempting to use
  test-train-split.

  \begin{itemize}
  \tightlist
  \item
    They are all the same variable, and yet have wildly different
    coefficients.
  \end{itemize}
\item
  However, I would say that housing grade seems to have a strong +
  relationship with sales price, the higher the grade the higher the
  sales price
\item
  The square footage of the living area is also + correlated with sales
  price.
\item
  The squarefootage of the basement also has a strong + relationship
  with salesprice.
\end{itemize}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
